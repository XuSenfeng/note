# 内核

## 设备树

### 屏幕

[Home · notro/fbtft Wiki](https://github.com/notro/fbtft/wiki)

对应的驱动是drivers/staging/fbtft/fb_st7789v.c, 使用的fb设备

```json
&spi0 {
	pinctrl-0 = <&spi0m0_clk &spi0m0_miso &spi0m0_mosi &spi0m0_cs0>;
	#address-cells = <1>;
	#size-cells = <0>;
	spidev@0 {
    	compatible = "rockchip,spidev";
		spi-max-frequency = <60000000>;
		reg = <0>;
	};

	fbtft@0{
		compatible = "sitronix,st7789v";
		reg = <0>;
		spi-max-frequency = <60000000>;
		fps = <60>;
		buswidth = <8>;
		debug = <0x7>;
		rotate = <270>;
		//bgr = <1>;	//RGB->BGR
		//led-gpios = <&gpio1 RK_PC5 GPIO_ACTIVE_HIGH>;		//BL
		dc-gpios = <&gpio1 RK_PD0 GPIO_ACTIVE_HIGH>;		//DC
		reset-gpios = <&gpio1 RK_PC4 GPIO_ACTIVE_LOW>;		//RES
	};
};
```

### 触摸

对应的驱动是drivers/input/touchscreen/focaltech_touch

```json
&i2c3 {
	status = "okay";
	clock-frequency = <100000>;
    focaltech@38 { 
		compatible = "focaltech,fts";	
		reg = <0x38>;  					
		interrupt-parent = <&gpio1>;				
		interrupts = <RK_PC7 IRQ_TYPE_EDGE_FALLING>;
		focaltech,reset-gpio = <&gpio1 RK_PC6 GPIO_ACTIVE_LOW>;
		focaltech,irq-gpio = <&gpio1 RK_PC7 IRQ_TYPE_LEVEL_LOW>; 

		focaltech,max-touch-number = <5>;			
		focaltech,display-coords =  <0 0 240 320>;
		focaltech,rotate = <270>;
	};
};
```

