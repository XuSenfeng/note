# 时钟控制模块

四个层次

+ 晶振时钟
+ PLL于PFD时钟
+ PLL选择时钟
+ 根时钟/外设时钟

## 晶振时钟

芯片连接两个时钟24MHz主晶振以及一个32.768KHz用于RTC模块

## PLL与PFD时钟

实际一个用于倍频的电路, 7路锁相环电路

-  ARM_PLL：驱动 ARM 内核
-  528_PLL：倍频参数固定为22，系统总线时钟, 固定是528MHz
-  USB1_PLL：驱动第一个 USB 物理层
-  AUDIO_PLL：驱动音频接口
-  VIDEO_PLL：驱动视频接口
-  ENET_PLL：驱动外部以太网接口
-  USB2_PLL：驱动第二个 USB 物理层

> 主要需要关注的时候528PLL以及USB1PLL
>
> PLL输出的时钟在需要通过PFD进行分频, 一路PLL可以获取到四路不同频率的时钟

![image-20250714093631291](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202507140936485.png)

#### PLL选择时钟

对 PLL1 和 PLL3 的输出进行选择、对 PLL4 和 PLL5 进行分频

- cpu内核时钟来于PLL1时钟。

- 刚上电时，PLL1时钟未初始化，arm内核先使用24M晶振频率，等PLL1时钟稳定输出后，再切换回PLL1时钟。

![image-20250714094153368](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202507140941449.png)

- CCM_ANALOG_PLL_XXX
    - 设置PPL时钟主频(pll1_main_clk)
    - 使能PLL时钟输出

- CCM_ANALOG_PFD_XXX
    - 设置PPL下PFD的分频系数

![image-20250714180317070](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202507141803206.png)