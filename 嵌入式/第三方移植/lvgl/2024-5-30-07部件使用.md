---
layout: post
title: "lvgl部件使用" 
date:   2024-1-11 15:39:08 +0800
tags: stm32 lvgl
---

# 部件使用

## lv_lable标签

主要用于文本的显示, 标题提示信息等

+ 主体LV_PART_MAIN
+ 滚动条LV_PART_SCROLLBAR
+ 选中的文本LV_PART_SELECTED

### 创建以及设置文本

```c
lv_obj_t *lable = lv_label_create(lv_scr_act());
lv_label_set_text(lable, "Hello World");
```

+ 设置文本有三种方式

1. 直接设置

```c
void lv_label_set_text(lv_obj_t * obj, const char * text);
```

> 这一个文本放在文本的动态内存里面

2. 文本在指定的缓冲区里面

```c
void lv_label_set_text_static(lv_obj_t * obj, const char * text);
```

> 这一个内存被释放以及被改写的话这一个获取的信息是不可靠的, 这一个文本从代码段过来的话, 是不可以进行修改的

3. With [lv_label_set_text_fmt](https://docs.lvgl.io/master/API/widgets/label/lv_label.html#_CPPv421lv_label_set_text_fmtP8lv_obj_tPKcz)(label, "Value: %d", 15) printf formatting can be used to set the text.

```c
void lv_label_set_text_fmt(lv_obj_t * obj, const char * fmt, ...)
```

### 设置长文本模式

当这一个标签没有设置宽度的时候, 会自动扩展, 设置的话需要设置这一个标签的长文本模式

```c
void lv_label_set_long_mode(lv_obj_t *obj, lv_label_long_mode_t long_mode)
```

> ```c
> enum {
>     LV_LABEL_LONG_WRAP,             /**< Keep the object width, wrap the too long lines and expand the object height*/
>     LV_LABEL_LONG_DOT,              /**< 在最后加点*/
>     LV_LABEL_LONG_SCROLL,           /**< 查出的时候循环(左右移动)*/
>     LV_LABEL_LONG_SCROLL_CIRCULAR,  /**< 文本超出的时候循环播放(一周)*/
>     LV_LABEL_LONG_CLIP,             /**< Keep the size and clip the text out of it*/
> };
> ```

### 设置文本样式

```c
void lv_obj_set_style_text_color(struct _lv_obj_t * obj, lv_color_t value, lv_style_selector_t selector);
void lv_obj_set_style_text_color_filtered(struct _lv_obj_t * obj, lv_color_t value, lv_style_selector_t selector);
void lv_obj_set_style_text_opa(struct _lv_obj_t * obj, lv_opa_t value, lv_style_selector_t selector);
void lv_obj_set_style_text_font(struct _lv_obj_t * obj, const lv_font_t * value, lv_style_selector_t selector);
void lv_obj_set_style_text_letter_space(struct _lv_obj_t * obj, lv_coord_t value, lv_style_selector_t selector);
void lv_obj_set_style_text_line_space(struct _lv_obj_t * obj, lv_coord_t value, lv_style_selector_t selector);
void lv_obj_set_style_text_decor(struct _lv_obj_t * obj, lv_text_decor_t value, lv_style_selector_t selector);
void lv_obj_set_style_text_align(struct _lv_obj_t * obj, lv_text_align_t value, lv_style_selector_t selector);
```

还可以设置背景, 设置背景的时候需要设置透明度, 设置字体的时候需要在lv_conf.h这一个文件里面把这一个字体进行改变

+ 设置个别字体的颜色

```c
lv_label_set_recolor(label2, true);
lv_label_set_text(label2, "It is a #ff0000 circularly# scrolling text.");
```

> 颜色后面需要有一个空格

+ 阴影

实际是把这一个文本绘制两遍, 后面的那一个颜色比较浅

```c
    /*Create a style for the shadow*/
    static lv_style_t style_shadow;
    lv_style_init(&style_shadow);
    lv_style_set_text_opa(&style_shadow, LV_OPA_30); //设置为透明度为30
    lv_style_set_text_color(&style_shadow, lv_color_black());

    /*Create a label for the shadow first (it's in the background)*/
    lv_obj_t * shadow_label = lv_label_create(lv_scr_act());
    lv_obj_add_style(shadow_label, &style_shadow, 0);

    /*Create the main label*/
    lv_obj_t * main_label = lv_label_create(lv_scr_act());
    lv_label_set_text(main_label, "A simple method to create\n"
                      "shadows on a text.\n"
                      "It even works with\n\n"
                      "newlines     and spaces.");

    /*Set the same text for the shadow label*/
    lv_label_set_text(shadow_label, lv_label_get_text(main_label));

    /*Position the main label*/
    lv_obj_align(main_label, LV_ALIGN_CENTER, 0, 0);

    /*Shift the second label down and to the right by 2 pixel*/
    lv_obj_align_to(shadow_label, main_label, LV_ALIGN_TOP_LEFT, 2, 2);
```

```c
    static lv_style_t style;
    lv_style_init(&style);
    lv_style_set_bg_opa(&style, LV_OPA_40);
    lv_style_set_bg_color( &style, lv_color_hex(0xff0000) ); //设置背景色
    lv_style_set_bg_grad_color( &style, lv_color_hex( 0x0000ff ) ); //设置过度
    lv_style_set_bg_grad_dir(&style, LV_GRAD_DIR_HOR);
    lv_style_set_text_color(&style, lv_color_white());

    lv_obj_t *label = lv_label_create(lv_scr_act());
    lv_label_set_text(label, "Hello World!");
    lv_obj_add_style(label, &style, LV_STATE_DEFAULT);

    // lv_obj_set_style_bg_opa(label, LV_OPA_COVER, LV_PART_MAIN);
    // lv_obj_set_style_bg_color(label, lv_color_hex(0x00ff00), LV_PART_MAIN);

    lv_obj_align(label, LV_ALIGN_CENTER, 0, 0);
```

## 按钮

和基础对象相比没有加入新的东西, 默认的点击效果是放大

```c
lv_obj_add_flag(btn, LV_OBJ_FLAG_CLICKABLE);
lv_obj_add_event_cb(btn, btn_event_cb, LV_EVENT_CLICKED, NULL);
```

有两个可以添加的标志LV_OBJ_FLAG_CLICKABLE, 这时候LV_EVENT_VALUE_CHANGED这一个回调会被触发

> 需要设置字体的时候, 需要一个lable对象以这一个按钮位父对象