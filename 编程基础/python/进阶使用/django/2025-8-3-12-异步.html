<!DOCTYPE html>

<html lang="zh-CN"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <meta name="html-generator" content="teedoc-plugin-jupyter-notebook-parser">
        
        <script src="/note/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/note/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/note/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/note/static/css/search/style.css" type="text/css"/>
        
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?4d52982572d5512e9762879ebf063c86";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
        
        <meta name="blog-generator" content="teedoc-plugin-blog">
        
        <link rel="stylesheet" href="/note/static/css/gitalk/gitalk.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/gitalk/custom_gitalk.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/custom.css" type="text/css"/>
        
    
    
    <title>WSGI和ASGI - XvSenfeng's Note</title>
    
    <script type="text/javascript">js_vars = {"teedoc-plugin-ad-hint": {"type": "hint", "label": "☆", "content": "这是一个支持国际化的消息示例</br>喜欢项目请<a target=\"_blank\" href=\"https://github.com/teedoc/teedoc\">点下 ☆ star </a>哦~🦀🦀", "show_times": 2, "show_after_s": 432000, "date": "2021-11-16 14:40", "color": "#a0421d", "link_color": "#e53935", "link_bg_color": "#e6ae5c", "bg_color": "#ffcf89", "color_hover": "white", "bg_color_hover": "#f57c00", "close_color": "#eab971"}}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": null, "update": [], "ts": 0, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/note/">
                
                    <img class="site_logo" src="/note/static/image/logo.png" alt="XvSenfeng logo">
                
                
                    <h2>XvSenfeng</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class=""><a  href="/note/blog/">博客</a></li>
<li class=""><a  href="/note/Linux/">Linux</a></li>
<li class=""><a  href="/note/代码分析/">代码分析</a></li>
<li class=""><a  href="/note/使用软件/">使用软件</a></li>
<li class=""><a  href="/note/嵌入式/">嵌入式</a></li>
<li class=""><a  href="/note/手机安卓/">手机安卓</a></li>
<li class=""><a  href="/note/机器学习/">机器学习</a></li>
<li class="active"><a  href="/note/编程基础/">编程基础</a></li>
<li class=""><a  href="/note/网络/">网络</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://github.com/XuSenfeng/note/">github</a></li>
</ul>

                <ul class="nav_plugins"><li><a id="google_translate_element"><img class="icon" src="/note/static/image/google_translate/translate.svg"/>Translate</a></li></ul><ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">搜索</span>
                            <div id="search_hints">
                                <span id="search_input_hint">输入关键词，多关键词空格隔开</span>
                                <span id="search_loading_hint">正在加载，请稍候。。。</span>
                                <span id="search_download_err_hint">下载文件失败，请刷新重试或检查网络</span>
                                <span id="search_other_docs_result_hint">来自其它文档的结果</span>
                                <span id="search_curr_doc_result_hint">当前文档搜索结果</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/note/编程基础/index.html"><span class="label">README</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">C#</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/no_translate.html?ref=C.html&from=/编程基础/C.html"><span class="label">2023-6-24-1.C#</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">C和指针</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-25-C语言环境.html"><span class="label">2022-7-25-C语言环境</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-25-字符串操作.html"><span class="label">2022-7-25-字符串操作</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-25-操作符和表达式.html"><span class="label">2022-7-25-操作符和表达式</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-25-数据.html"><span class="label">2022-7-25-数据</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-25-词法规则.html"><span class="label">2022-7-25-词法规则</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-25-语句.html"><span class="label">2022-7-25-语句</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-26-函数.html"><span class="label">2022-7-26-函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-26-指针.html"><span class="label">2022-7-26-指针</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-26-数组.html"><span class="label">2022-7-26-数组</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-26-表达式.html"><span class="label">2022-7-26-表达式</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-27-动态内存分配.html"><span class="label">2022-7-27-动态内存分配</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-27-字符串字符字节.html"><span class="label">2022-7-27-字符串字符字节</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-27-结构体和指针.html"><span class="label">2022-7-27-结构体和指针</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-27-结构和联合.html"><span class="label">2022-7-27-结构和联合</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-28-预处理器.html"><span class="label">2022-7-28-预处理器</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-28-高级指针.html"><span class="label">2022-7-28-高级指针</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-29-输入输出函数.html"><span class="label">2022-7-29-输入输出函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-30-标准库函数.html"><span class="label">2022-7-30-标准库函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-30-经典抽象数据类型.html"><span class="label">2022-7-30-经典抽象数据类型</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C和指针/2022-7-31-运行时环境.html"><span class="label">2022-7-31-运行时环境</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">C陷阱与缺陷</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/C陷阱与缺陷/2022-8-26-函数.html"><span class="label">2022-8-26-函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/C陷阱与缺陷/2022-8-27-语义陷阱.html"><span class="label">2022-8-27-语义陷阱</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">c</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/c/2023-6-16-c监控.html"><span class="label">2023-6-16-c监控</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/c/2023-6-19-C语言程序设计.html"><span class="label">2023-6-19-C语言程序设计</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">cpp</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/cpp/2025-1-1-01C++.html"><span class="label">2025-1-1-01C++</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/cpp/2025-1-1-02内存.html"><span class="label">2025-1-1-02内存</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/cpp/2025-1-22-其他扩展语法.html"><span class="label">2025-1-22-其他扩展语法</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/cpp/2025-1-26-多线程.html"><span class="label">2025-1-26-多线程</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/cpp/2025-1-6-03模板和STL.html"><span class="label">2025-1-6-03模板和STL</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">go</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/go/2022-8-26-函数.html"><span class="label">2022-8-26-函数</span><span class=""></span></a></li>
</ul>
</li>
<li class="active_parent no_link"><a><span class="label">python</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active no_link"><a><span class="label">基础语法</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2023-6-15-修饰器.html"><span class="label">2023-6-15-修饰器</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2023-9-23-01基础运算.html"><span class="label">2023-9-23-01基础运算</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2023-9-24-02函数及变量.html"><span class="label">2023-9-24-02函数及变量</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-23-03虚拟环境.html"><span class="label">2024-4-23-03虚拟环境</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-23-04常用函数.html"><span class="label">2024-4-23-04常用函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-24-05程序获取参数.html"><span class="label">2024-4-24-05程序获取参数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-25-06推导式和拆包.html"><span class="label">2024-4-25-06推导式和拆包</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-25-07引入.html"><span class="label">2024-4-25-07引入</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-25-08匿名函数.html"><span class="label">2024-4-25-08匿名函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-25-09面向对象.html"><span class="label">2024-4-25-09面向对象</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-26-10文件基本操作.html"><span class="label">2024-4-26-10文件基本操作</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-27-11OS模块.html"><span class="label">2024-4-27-11OS模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-27-12迭代器.html"><span class="label">2024-4-27-12迭代器</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-27-13异常处理.html"><span class="label">2024-4-27-13异常处理</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-27-14生成器.html"><span class="label">2024-4-27-14生成器</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-28-15闭包.html"><span class="label">2024-4-28-15闭包</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-4-30-16深拷贝浅拷贝.html"><span class="label">2024-4-30-16深拷贝浅拷贝</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-5-1-17With和上下文管理器.html"><span class="label">2024-5-1-17With和上下文管理器</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-5-4-18GIL.html"><span class="label">2024-5-4-18GIL</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2024-5-4-19垃圾回收.html"><span class="label">2024-5-4-19垃圾回收</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2025-1-31-多任务.html"><span class="label">2025-1-31-多任务</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2025-12-19-CPP交互使用.html"><span class="label">2025-12-19-CPP交互使用</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2025-12-19-打包whl文件.html"><span class="label">2025-12-19-打包whl文件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2025-2-25-yaml.html"><span class="label">2025-2-25-yaml</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/基础语法/2025-3-21-包导入.html"><span class="label">2025-3-21-包导入</span><span class=""></span></a></li>
</ul>
</li>
<li class="active_parent no_link"><a><span class="label">进阶使用</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active no_link"><a><span class="label">C语言-Cpp接轨</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/C语言-Cpp接轨/2025-12-10-01-struct.html"><span class="label">2025-12-10-01-struct</span><span class=""></span></a></li>
</ul>
</li>
<li class="active_parent no_link"><a><span class="label">django</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-24-01-Django.html"><span class="label">2025-7-24-01-Django</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-24-02-创建.html"><span class="label">2025-7-24-02-创建</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-24-03-路由.html"><span class="label">2025-7-24-03-路由</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-24-04-视图.html"><span class="label">2025-7-24-04-视图</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-24-05-配置文件.html"><span class="label">2025-7-24-05-配置文件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-26-04-模版.html"><span class="label">2025-7-26-04-模版</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-28-05-静态文件.html"><span class="label">2025-7-28-05-静态文件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-29-06-中间件.html"><span class="label">2025-7-29-06-中间件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-29-07-数据库.html"><span class="label">2025-7-29-07-数据库</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-7-30-08-进阶数据查询.html"><span class="label">2025-7-30-08-进阶数据查询</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-8-1-09-ORM优化.html"><span class="label">2025-8-1-09-ORM优化</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-8-2-10-模型扩展.html"><span class="label">2025-8-2-10-模型扩展</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-8-2-11-组件.html"><span class="label">2025-8-2-11-组件</span><span class=""></span></a></li>
<li class="active with_link"><a href="/note/编程基础/python/进阶使用/django/2025-8-3-12-异步.html"><span class="label">2025-8-3-12-异步</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">pyQT</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-11-08界面容器.html"><span class="label">2024-5-11-08界面容器</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-6-01介绍以及安装.html"><span class="label">2024-5-6-01介绍以及安装</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-6-02控件.html"><span class="label">2024-5-6-02控件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-7-03布局.html"><span class="label">2024-5-7-03布局</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-7-04窗口.html"><span class="label">2024-5-7-04窗口</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-8-05信号与槽.html"><span class="label">2024-5-8-05信号与槽</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-8-06QTDesigner.html"><span class="label">2024-5-8-06QTDesigner</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/pyQT/2024-5-8-07线程.html"><span class="label">2024-5-8-07线程</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">简单模块使用</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/简单模块使用/2024-5-4-01logging日志模块.html"><span class="label">2024-5-4-01logging日志模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/简单模块使用/2025-3-15-02fastapi.html"><span class="label">2025-3-15-02fastapi</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">线程</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/线程/2024-5-10-01多任务.html"><span class="label">2024-5-10-01多任务</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/线程/2024-5-14-02队列.html"><span class="label">2024-5-14-02队列</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/线程/2025-2-20-async.html"><span class="label">2025-2-20-async</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">网络编程</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/网络编程/2024-5-10-01网络编程.html"><span class="label">2024-5-10-01网络编程</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/网络编程/2024-5-10-02Socket.html"><span class="label">2024-5-10-02Socket</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/网络编程/2024-5-12-03软件.html"><span class="label">2024-5-12-03软件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/python/进阶使用/网络编程/2024-8-20-04MQTT.html"><span class="label">2024-8-20-04MQTT</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">前端</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/前端/2024-8-12-04CSS2.html"><span class="label">2024-8-12-04CSS2</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/前端/2024-8-5-01基础知识.html"><span class="label">2024-8-5-01基础知识</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/前端/2024-8-5-02HTML.html"><span class="label">2024-8-5-02HTML</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/前端/2024-8-6-03CSS.html"><span class="label">2024-8-6-03CSS</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">嵌入式C语言</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-21-__attribute__.html"><span class="label">2022-7-21-__attribute__</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-21-内联函数内置内存函数.html"><span class="label">2022-7-21-内联函数内置内存函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-21-变量指针.html"><span class="label">2022-7-21-变量指针</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-21-大小端数据对齐size_t.html"><span class="label">2022-7-21-大小端数据对齐size_t</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-21-存储器.html"><span class="label">2022-7-21-存储器</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-21-语句表达式define.html"><span class="label">2022-7-21-语句表达式define</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-Linux中的面向对象思想-封装.html"><span class="label">2022-7-22-Linux中的面向对象思想-封装</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-main函数的参数.html"><span class="label">2022-7-22-main函数的参数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-二级指针.html"><span class="label">2022-7-22-二级指针</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-代码复用分层思想.html"><span class="label">2022-7-22-代码复用分层思想</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-函数参数的本质.html"><span class="label">2022-7-22-函数参数的本质</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-函数指针.html"><span class="label">2022-7-22-函数指针</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-指针和数组.html"><span class="label">2022-7-22-指针和数组</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-22-面向对象编程基础.html"><span class="label">2022-7-22-面向对象编程基础</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-goto关键字.html"><span class="label">2022-7-23-goto关键字</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-可重入函数.html"><span class="label">2022-7-23-可重入函数</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-多任务.html"><span class="label">2022-7-23-多任务</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-头文件剖析.html"><span class="label">2022-7-23-头文件剖析</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-异步通信模式.html"><span class="label">2022-7-23-异步通信模式</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-操作系统基本原理.html"><span class="label">2022-7-23-操作系统基本原理</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-模块化编程.html"><span class="label">2022-7-23-模块化编程</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-模块进阶.html"><span class="label">2022-7-23-模块进阶</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-23-模块间通讯.html"><span class="label">2022-7-23-模块间通讯</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-24-MMU内存管理单元.html"><span class="label">2022-7-24-MMU内存管理单元</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-24-中断.html"><span class="label">2022-7-24-中断</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-24-寄存器操作.html"><span class="label">2022-7-24-寄存器操作</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-24-嵌入式启动.html"><span class="label">2022-7-24-嵌入式启动</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-24-文件系统.html"><span class="label">2022-7-24-文件系统</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-24-系统调用.html"><span class="label">2022-7-24-系统调用</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/嵌入式C语言/2022-7-24-进程线程协程.html"><span class="label">2022-7-24-进程线程协程</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">算法基础</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/编程基础/算法基础/2022-7-31-高级数据结构.html"><span class="label">2022-7-31-高级数据结构</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/算法基础/2024-12-31-01快速排序.html"><span class="label">2024-12-31-01快速排序</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/算法基础/2024-12-31-02哈希表.html"><span class="label">2024-12-31-02哈希表</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/编程基础/算法基础/2024-12-31-03贪心算法.html"><span class="label">2024-12-31-03贪心算法</span><span class=""></span></a></li>
</ul>
</li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>WSGI和ASGI</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="最后修改日期： 2025-12-14">
                                    2025-12-14
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                            <div id="source_link">
                                <a href="https://github.com/XuSenfeng/note/tree/master/doc/编程基础/python/进阶使用/django/2025-8-3-12-异步.md" target="_blank">
                                    编辑本页
                                </a>
                            </div>
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <p>WSGI和ASGI，都是基于Python设计的网关接口（Gateway Interface，GI）。</p>
<p>WSGI是python语言基于http协议模式开发的，不支持websocket协议，而ASGI的诞生解决了python中的WSGI不支持当前的web开发中的一些新的协议标准，同时ASGI支持原有模式和Websocket的扩展，即ASGI是WSGI的扩展。</p>
<h2 id="%E5%9F%BA%E7%A1%80%E5%AE%9A%E4%B9%89">基础定义</h2>
<h3 id="%E7%BD%91%E5%85%B3%E6%8E%A5%E5%8F%A3">网关接口</h3>
<p>网关接口（Gateway Interface，GI）就是一种为了实现加载动态脚本而运行在Web服务器和Web应用程序中的通信接口，也可以理解为一份协议/规范。只有Web服务器和Web应用程序都实现了网关接口规范以后，双方的通信才能顺利完成。常见的网关接口协议：CGI，FastCGI，WSGI，ASGI。</p>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202508031319966.png" alt="image-20210608222947398" /></p>
<h3 id="CGI">CGI</h3>
<p>公共网关接口（Common Gateway Interface，CGI）是最早的Web服务器主机提供信息服务的标准接口规范。只要实现了CGI协议，Web服务器就能够获取并了解客户端提交的信息，转交给服务器端的web应用程序进行处理，最后返回结果给客户端。</p>
<p>CGI程序是一种实现了CGI协议的程序。</p>
<p>快速通用网关接口（Fast Common Gateway Interface／FastCGI）是一种让web应用程序与Web服务器通信的协议。FastCGI是公共网关接口（CGI）的增强版本。</p>
<h3 id="Web%E6%9C%8D%E5%8A%A1%E5%99%A8">Web服务器</h3>
<p>Web服务器（Web Server）是一种运行于网站后台（物理服务器）的软件。Web服务器主要用于提供网页浏览或文件下载服务，它可以向浏览器等Web客户端提供html网页文档，也可以提供其他类型的可展示文档，让客户端用户浏览；还可以提供数据文件下载等。目前世界上最主流的Web服务器有 Nginx 、Apache、IIS、tomcat。</p>
<h3 id="Web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">Web应用程序</h3>
<p>Web应用程序（Web Programming Application）是一种能完成web业务逻辑，能让用户基于web浏览器访问的应用程序，它可以是一个实现http请求和响应功能的函数或者类，也可以是Django、Flask、FastAPI等这样的web框架，当然也可以是其他语言的web程序或web框架。</p>
<blockquote>
<p>问：Web服务器和Web应用程序的区别？<br />
答：Web应用程序主要是完成web应用的业务逻辑的处理，Web服务器则主要是应对外部请求的接收、响应和转发。<br />
    需要使用web服务器启动运行，web应用程序才能被用户访问到。<br />
    而django框架中，我们之所以只有一个web应用程序就跑起来了，是因为我们在终端执行了一个命令，python manage.py runserver。<br />
    这个命令启动了django框架中内置提供的测试web服务器。</p>
</blockquote>
<h2 id="WSGI">WSGI</h2>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202508031329264.png" alt="image-20210608223815714" /></p>
<p>Web服务器网关接口（Web Server Gateway Interface，WSGI），是Python为了解决<strong>Web服务器端与客户端之间的通信</strong>基于CGI标准而设计的。实现了WSGI协议的web服务器有：uWSGI、<a href="https://gunicorn.org/"  target="_blank">gunicorn</a>、uvicorn、<a href="https://pgjones.gitlab.io/hypercorn/"  target="_blank">Hypercorn</a>。像django框架开发的项目一般在线上服务器运行就不会使用runserver来运行，而是采用上面实现了WSGI协议的web服务器来运行。</p>
<p>django中运行runserver命令时，其实内部就启动了wsgiref模块作为web服务器运行的。wsgiref是python内置的一个简单地遵循了wsgi接口规范的web服务器程序。</p>
<h3 id="WSGI-web%E6%9C%8D%E5%8A%A1%E5%99%A8">WSGI web服务器</h3>

<pre class="language-python"><code class="language-python">from wsgiref.simple_server import make_server
# application 由wsgi服务器调用、函数对http请求与响应的封装、使得Python专注于HTML
# environ http 请求 (是一个字典)
# start_response 响应 (是一个函数)

def application(environ, start_response):
    &quot;&quot;&quot;web应用程序&quot;&quot;&quot;
    # 判断请求
    if environ['REQUEST_METHOD'] == 'GET' and environ['PATH_INFO'] == '/':
        # 响应
        start_response('200 OK', [('Content-Type', 'text/html')])
        return [b'&lt;h1&gt;hi, python!&lt;/h1&gt;']
    # 判断请求
    elif environ['REQUEST_METHOD'] == 'GET' and environ['PATH_INFO'] == '/python':
        # 响应
        start_response('200 OK', [('Content-Type', 'text/html')])
        return [b&quot;&lt;h1&gt;it work!&lt;/h1&gt;&quot;]

if __name__ == '__main__':
    # 启动服务器 | 这个服务器负责与 wsgi 接口的 application 函数对接数据
    httpd = make_server('127.0.0.1', 8888, application)

    # 监听请求
    httpd.serve_forever()

    # 1. 监听8000端口,
    # 2. 把http请求根据WSGI协议将其转换到applcation中的environ参数, 然后调用application函数.
    # 3. wsgiref会把application函数提供的响应头设置转换为http协议的响应头,
    # 4. 把application的返回(return)作为响应体, 根据http协议,生成响应, 返回给浏览器.

    # http://127.0.0.1:8888/
    # http://127.0.0.1:8888/python
</code></pre>
<p>开发中，我们一般使用uWSGI或者Gunicorn作为web服务器运行django。</p>
<h3 id="uWSGI">uWSGI</h3>
<p><a href="https://uwsgi-docs.readthedocs.io/"  target="_blank">uWSGI</a> 是一个快速的，自我驱动的，对开发者和系统管理员友好的应用容器服务器，完全由 C 编写，实现了WSGI协议,uwsgi,http等协议。注意：uwsgi 协议是一个 uWSGI服务器自有的协议,用于定义传输信息的类型，常用于uWSGI服务器与其他网络服务器的数据通信中。</p>
<p>文档：<a href="https://docs.djangoproject.com/zh-hans/3.2/howto/deployment/wsgi/uwsgi/"  target="_blank">https://docs.djangoproject.com/zh-hans/3.2/howto/deployment/wsgi/uwsgi/</a></p>
<p>配置：<a href="https://uwsgi.readthedocs.io/en/latest/Configuration.html"  target="_blank">https://uwsgi.readthedocs.io/en/latest/Configuration.html</a></p>

<pre class="language-none"><code class="language-none">conda config --add channels conda-forge
conda install uWSGI
</code></pre>
<p>项目根目录下创建uwsgi配置文件，uwsgi.ini(不是python文件)，代码样本：</p>

<pre class="language-none"><code class="language-none">[uwsgi]
#使用nginx连接时使用，Django程序所在服务器地址
socket=0.0.0.0:8000
#直接做web服务器使用，Django程序所在服务器地址
# http=0.0.0.0:8000
#项目目录
chdir=项目根目录绝对路径
#项目中wsgi.py文件的目录，相对于项目目录
wsgi-file=主应用目录/wsgi.py
# 进程数 CPU * 2 -1
processes=4
# 线程数
threads=2
# uwsgi服务器的角色
master=True
# 存放进程编号的文件
pidfile=uwsgi.pid
# 日志文件，因为uwsgi可以脱离终端在后台运行，日志看不见。我们以前的runserver是依赖终端的
daemonize=uwsgi.log
# 指定依赖的虚拟环境
virtualenv=虚拟环境的绝对路径
</code></pre>
<p>uwsgi.ini，代码：</p>

<pre class="language-none"><code class="language-none">[uwsgi]
# 使用nginx连接时使用，Django程序所在服务器地址
# socket=0.0.0.0:8000
# 直接做web服务器使用，Django程序所在服务器地址
http=0.0.0.0:8000
# 项目目录
# chdir=项目根目录，务必使用绝对路径
chdir=/home/moluo/Desktop/djdemo
# 项目中wsgi.py文件的目录，相对于项目根目录
wsgi-file=djdemo/wsgi.py
# 进程数 CPU * 2 - 1 , 也可以不减1
processes= 4
# 线程数 CPU数量
threads=2
# uwsgi服务器的角色
master=True
# 存放进程编号的文件
pidfile=uwsgi.pid
# 日志文件，因为uwsgi可以脱离终端在后台运行，日志看不见。我们以前的runserver是依赖终端的
daemonize=uwsgi.log
# 指定依赖的虚拟环境
# virtualenv=/root/.virtualenvs/环境名称
virtualenv=/home/moluo/anaconda3/envs/djdemo
</code></pre>
<p>项目根目录下，启动uwsgi服务器</p>

<pre class="language-bash"><code class="language-bash"># 启动项目
uwsgi --ini uwsgi.ini

# 停止运行
uwsgi --stop uwsgi.pid  # 调用系统的 kill -9 uwsgi.pid中的进程号

# 查看当前系统中的指定名称的进程
ps aux | grep uwsgi

# 输出效果如下，则表示成功运行，接下来就可以根据配置中设置的地址访问项目了。
# (base) moluo@ubuntu:~$ ps aux | grep uwsgi
# moluo      12759  2.3  0.9  96944 37736 ?        S    11:52   0:00 uwsgi --ini uwsgi.ini
# moluo      13167  0.0  0.7 170676 29468 ?        Sl   11:52   0:00 uwsgi --ini uwsgi.ini
# moluo      13169  0.0  0.7 170676 29468 ?        Sl   11:52   0:00 uwsgi --ini uwsgi.ini
# moluo      13171  0.0  0.7 170676 29468 ?        Sl   11:52   0:00 uwsgi --ini uwsgi.ini
# moluo      13173  0.0  0.7 170676 29468 ?        Sl   11:52   0:00 uwsgi --ini uwsgi.ini
# moluo      13176  0.0  0.8 105140 35416 ?        S    11:52   0:00 uwsgi --ini uwsgi.ini
# moluo      18073  0.0  0.0  17688   740 pts/2    R+   11:52   0:00 grep --color=auto uwsgi
</code></pre>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202508031514654.png" alt="image-20210609121333733" /></p>
<h2 id="ASGI">ASGI</h2>
<p>ASGI，是构建于WSGI接口规范之上的<strong>异步服务器网关接口</strong>，是WSGI的延伸和扩展。</p>

<pre class="language-none"><code class="language-none">A指的是Async，异步的意思。 
</code></pre>
<table>
<thead>
<tr>
  <th>协议，规范</th>
  <th>支持的请求协议（常见，未列全）</th>
  <th>同步/异步</th>
  <th>支持的框架</th>
</tr>
</thead>
<tbody>
<tr>
  <td>CGI</td>
  <td>HTTP</td>
  <td></td>
  <td>CGI程序</td>
</tr>
<tr>
  <td>WSGI</td>
  <td>HTTP</td>
  <td>同步</td>
  <td>django3.0以前，Flask1.0</td>
</tr>
<tr>
  <td>ASGI</td>
  <td>HTTP，HTTP2，WebSocket等</td>
  <td>同步/异步</td>
  <td>FastAPI，Tornado，django3.1以后，flask2.0</td>
</tr>
</tbody>
</table>
<p>在 Python3.5 之后增加 async/await 特性之后简化了协程操作以后，异步编程变得异常火爆，越来越多开发者投入异步的怀抱。</p>
<p>3.0版本以前，django所提供的所有内部功能都是基于同步编程的。所以，在以往django开发中，针对网络请求，数据库读取等IO操作形成的阻塞，往往会导致项目运行性能的下降。虽然等待I/O操作数微秒时，但是随着流量的增加和操作的频率上升，这一点点的阻塞就会导致整个项目运作的缓慢。而如果换成异步就不会有任何阻塞，还可以同时处理其他任务，从而以较低的延迟处理更多的请求。所以在目前python开发中，越来越多的框架开始支持了异步编程。所以，3.0版本以后，django开始支持异步编程，可以让开发者在django中使用python第三方异步模块，推出了asgi异步web服务器。3.1版本推出了异步视图，当然，目前django的异步编程还不够完善，django中只有极少的功能是支持了异步操作。</p>
<h3 id="Uvicorn">Uvicorn</h3>
<blockquote>
<p>Django支持的另一个web服务器</p>
</blockquote>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202508031518244.png" alt="image-20210608235013829" /></p>
<p>Uvicorn 是一个快速的 ASGI 服务器，Uvicorn 是基于 uvloop 和 httptools 构建的，是 Python 异步生态中重要的一员。</p>
<p>Uvicorn 当前支持 HTTP / 1.1 和 WebSockets，将来计划支持HTTP/2.0。</p>
<p>文档：<a href="https://www.uvicorn.org/"  target="_blank">https://www.uvicorn.org/</a></p>
<p>安装uvicorn</p>

<pre class="language-python"><code class="language-python">pip install uvicorn
</code></pre>
<p>项目根目录下，运行django项目, 实际是运行asgi.py 的application函数</p>

<pre class="language-bash"><code class="language-bash"># uvicorn 主应用目录名.asgi:application --reload
uvicorn djdemo.asgi:application --reload
</code></pre>
<p>开发中一般使用gunicorn来管理uvicorn。所以可以一并安装(不支持Windows)</p>
<blockquote>
<p><strong>Gunicorn</strong>（Green Unicorn）是一个成熟的WSGI（Web Server Gateway Interface）服务器，广泛用于同步的Python Web应用的部署（例如Django、Flask）。其特点是：</p>
<ul>
<li><strong>以同步模式运行</strong></li>
<li><strong>多进程模型</strong></li>
<li><strong>丰富的插件和扩展支持</strong></li>
</ul>
<p>随着异步Web框架变得流行，单纯的Gunicorn不支持异步功能，于是出现了一种常用的模式：<strong>将Gunicorn作为管理器，使用Uvicorn作为工作类（worker）</strong>。</p>
<h3 id="%E5%85%B3%E7%B3%BB%E6%80%BB%E7%BB%93">关系总结</h3>
<ul>
<li><strong>Uvicorn</strong> 是一个纯粹的ASGI服务器，专为异步应用设计，性能极佳。</li>
<li><strong>Gunicorn</strong> 提供强大的多进程管理和部署能力，不直接支持ASGI标准，但可以通过插件（类似 <code>uvicorn.workers.UvicornWorker</code>）实现对ASGI应用的支持。</li>
<li><strong>结合使用</strong>：通常在生产环境中，将Gunicorn作为管理进程，使用<code>UvicornWorker</code>作为worker类，来部署异步应用。这样既能利用Gunicorn的管理与扩展能力，又能享受Uvicorn的高性能异步处理。</li>
</ul>
</blockquote>

<pre class="language-none"><code class="language-none">pip install gunicorn
</code></pre>
<p>运行</p>

<pre class="language-none"><code class="language-none"># gunicorn -w 4 主应用目录名.asgi:application -k uvicorn.workers.UvicornWorker --reload
gunicorn -w 4 djdemo.asgi:application -k uvicorn.workers.UvicornWorker --reload
</code></pre>
<h3 id="Daphne">Daphne</h3>
<p><a href="https://docs.djangoproject.com/zh-hans/4.2/howto/deployment/asgi/daphne/"  target="_blank">如何使用 Daphne 托管 Django | Django documentation | Django</a></p>
<ul>
<li>由Django团队开发，最初为支持Channels设计</li>
<li>未来发展紧密结合Django生态</li>
</ul>

<pre class="language-bash"><code class="language-bash">python -m pip install daphne
daphne myproject.asgi:application
</code></pre>
<h4 id="%E4%B8%8E-%3Ccode%3Erunserver%3C/code%3E-%E9%9B%86%E6%88%90">与 <code>runserver</code> 集成</h4>
<p>Daphne 提供了一个 <a href="https://docs.djangoproject.com/zh-hans/4.2/ref/django-admin/#django-admin-runserver"  target="_blank"><code>runserver</code></a> 命令，用于在开发过程中使用 ASGI 来提供站点服务。</p>
<p>这可以通过将 <code>daphne</code> 添加到你的 <a href="https://docs.djangoproject.com/zh-hans/4.2/ref/settings/#std-setting-INSTALLED_APPS"  target="_blank"><code>INSTALLED_APPS</code></a> 的开头，并添加一个指向你的 ASGI 应用程序对象的 <code>ASGI_APPLICATION</code> 设置来启用：</p>

<pre class="language-none"><code class="language-none">INSTALLED_APPS = [
    &quot;daphne&quot;,
    ...,
]

ASGI_APPLICATION = &quot;myproject.asgi.application&quot;
</code></pre>
<h2 id="%E5%BC%82%E6%AD%A5%E8%A7%86%E5%9B%BE">异步视图</h2>
<p>文档：<a href="https://docs.djangoproject.com/zh-hans/4.2/topics/async/"  target="_blank">https://docs.djangoproject.com/zh-hans/4.2/topics/async/</a></p>
<h3 id="%E5%87%BD%E6%95%B0%E8%A7%86%E5%9B%BE">函数视图</h3>
<p>在Django3.1后的版本中，我们可以通过<code>async def</code>语法，将任何函数视图定义为异步视图。</p>

<pre class="language-python"><code class="language-python">&quot;&quot;&quot;同步视图&quot;&quot;&quot;
import time
def home1(request):
    time.sleep(5)
    return HttpResponse('Hello, sync view!')

&quot;&quot;&quot;异步视图&quot;&quot;&quot;
import asyncio
async def home2(request):
    # asyncio.sleep(5)
    await asyncio.sleep(5)  # 开发中，一般就是ORM操作，http请求，或者读取文件等IO操作，就需要在左边上加上 await
    return HttpResponse('Hello, async view!') 
</code></pre>
<h3 id="%E7%B1%BB%E8%A7%86%E5%9B%BE">类视图</h3>
<p>类视图，django内部是将它的<code>__call__()</code>方法定义为<code>async def</code>，成为异步视图。</p>

<pre class="language-python"><code class="language-python">class Home3View(View):
    async def __call__(self, *args, **kwargs): # 当把一个类当函数去调用，就会触发__call__方法
        return super().__call__(*args, **kwargs)

    async def get(self, request):
        await asyncio.sleep(5)
        return HttpResponse(&quot;ok, get&quot;) 
</code></pre>
<h2 id="%E6%A8%A1%E5%9E%8B%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C">模型异步操作</h2>
<p>django4.2版本的ORM对数据库的访问这块还没有全面实现异步处理，默认还是同步的。当我们需要在项目中调用模型进行异步操作时，django有提供了2个适配函数，可从<code>asgiref.sync</code>包中获取：<code>async_to_sync()</code>和 <code>sync_to_async()</code> 。它们用于同步和异步之间调用风格的转换，同时保持兼容性。适配函数既可以当包装函数使用，也可以作为装饰器使用。</p>
<p>async_to_sync()：异步转同步，参数就是同步函数</p>
<p>sync_to_async()：同步转异步，参数就是异步函数</p>

<pre class="language-python"><code class="language-python">from asgiref.sync import async_to_sync
# 用法1
sync_function = async_to_sync(async_function)

# 用法2
@async_to_sync
async def async_function(...):
    pass
</code></pre>
<p>代码：</p>

<pre class="language-python"><code class="language-python">from django.views import View
from django.http.response import JsonResponse
from component import models
from asgiref.sync import sync_to_async


# Create your views here.
class User1View(View):
    async def __call__(self, *args, **kwargs):
        return super().__call__(*args, **kwargs)

    async def get(self, request):
        &quot;&quot;&quot;因为是异步视图，无法直接使用同步代码，所以报错：SynchronousOnlyOperation&quot;&quot;&quot;
        # student = models.Student.objects.get(id=12)
        # print(student)

        &quot;&quot;&quot;在异步视图中，必须异步操作模型&quot;&quot;&quot;
        # sync_to_async(models.Student.objects.get, thread_sensitive=True)
        # 上面就是把 models.Student.objects.get 进行异步转换，在线程安全模式运行

        &quot;&quot;&quot;异步获取一条数据&quot;&quot;&quot;
        aget = sync_to_async(models.Student.objects.get, thread_sensitive=True)
        student = await aget(id=12)  # # aget就是get的异步方法，调用方法与原来的get一样
        return JsonResponse({&quot;msg&quot;: &quot;ok, get&quot;, &quot;data&quot;: {
            &quot;id&quot;: student.id,
            &quot;name&quot;: student.name,
        }})

        &quot;&quot;&quot;异步获取多条数据&quot;&quot;&quot;
        # QuerySet 惰性查询，all执行的时候，根本没发生数据操作，自然也就没有IO
        student_objs = models.Student.objects.all()
        student_list = []
        async for student in student_objs:
            student_list.append({
                &quot;id&quot;: student.id,
                &quot;name&quot;: student.name,
            })
        return JsonResponse({&quot;msg&quot;: &quot;ok, get&quot;, &quot;data&quot;: student_list})

        &quot;&quot;&quot;异步添加数据&quot;&quot;&quot;
        acreate = sync_to_async(models.Student.objects.create, thread_sensitive=False)
        student = await acreate(
            name=&quot;小柏&quot;,
            age=13,
            sex=True,
            mobile=&quot;13956567878&quot;,
            status=1,
            classmate=&quot;307&quot;,
            description=&quot;话不多数，上就完事了！&quot;)
        return JsonResponse({&quot;msg&quot;: &quot;ok, get&quot;, &quot;data&quot;: {
            &quot;id&quot;: student.id,
            &quot;name&quot;: student.name,
        }}, status=201) 
</code></pre>
<p>redis异步库：aioredis</p>
<p>mysql异步库：aiomysql</p>
<p>mongoDB异步库：motor</p>
<p>http网络请求异步库：httpx</p>
<h2 id="%E5%BC%82%E6%AD%A5HTTP%E8%AF%B7%E6%B1%82">异步HTTP请求</h2>
<p>views.py，代码：</p>

<pre class="language-python"><code class="language-python">import httpx
from django.views import View
from django.http.response import JsonResponse
from component import models
from asgiref.sync import sync_to_async


# Create your views here.
class User1View(View):
    async def __call__(self, *args, **kwargs):
        return super().__call__(*args, **kwargs)

    async def get(self, request):
        &quot;&quot;&quot;异步网络请求&quot;&quot;&quot;
        # 同步代码在遇到IO操作时就会出现阻塞，所以异步代码在IO时需要交出程序执行权
        async with httpx.AsyncClient() as client:
            response = await client.get(&quot;https://httpbin.org/get&quot;)
        return JsonResponse(response.json())

</code></pre>
<h2 id="%E5%BC%82%E6%AD%A5%E4%B8%AD%E9%97%B4%E4%BB%B6">异步中间件</h2>
<p>3.1版本以后，django还提供了中间件的异步支持。</p>
<p><a href="https://docs.djangoproject.com/zh-hans/4.2/topics/http/middleware/"  target="_blank">中间件 | Django documentation | Django</a></p>
<p>中间件支持同步和异步请求的任意组合。如果Django不能同时支持它们，它会调整请求来适应中间件的需求，但会有性能损失。</p>
<p>默认情况下，Django假设你的中间件只能处理同步请求。如果要改变这种模式，需要在你的中间件工厂函数或类中添加入如下属性：</p>
<ul>
<li><code>sync_capable</code> 是一个布尔值，来表明中间件是否处理同步请求。默认为 <code>True</code>。</li>
<li><code>async_capable</code> 是一个布尔值，来表明中间件是否处理异步请求。默认为 <code>False</code>。</li>
</ul>
<p>如果你的中间件同时设置了 <code>sync_capable = True</code> 和 <code>async_capable = True</code>，那么Django将直接传递请求而不进行转换。在这种情况下，你可以通过检查传递给你的 <code>get_response</code> 对象是否是协程函数，使用 <code>asgiref.sync.iscoroutinefunction</code> 来确定你的中间件是否会接收到异步请求。</p>

<pre class="language-python"><code class="language-python">&quot;&quot;&quot;
wsgiref 是python内置模块，提供给开发者在开发时，用于创建同步web服务器
asgiref 是python内置模块，提供给开发者在开发时，用于创建异步web服务器
&quot;&quot;&quot;
&quot;&quot;&quot;异步中间件&quot;&quot;&quot;


&quot;&quot;&quot;异步函数中间件&quot;&quot;&quot;
from asgiref.sync import iscoroutinefunction
# iscoroutinefunction 是python内置 判断当前参数是否是协程函数，如果是协程函数，则返回值为True，否则False
def simple_middleware(get_response):
    if iscoroutinefunction(get_response):
        async def middleware(request):
            response = await get_response(request)
            return response
    else:
        def middleware(request):
            response = get_response(request)
            return response
    return middleware


&quot;&quot;&quot;异步类中间件&quot;&quot;&quot;
from asgiref.sync import iscoroutinefunction, markcoroutinefunction
# markcoroutinefunction 把当前参数标记为协程函数


class SimpleMiddleware2:
    &quot;&quot;&quot;异步中间件&quot;&quot;&quot;
    async_capable = True
    sync_capable = False

    def __init__(self, get_response):
        self.get_response = get_response
        if iscoroutinefunction(self.get_response):
            markcoroutinefunction(self)

    async def __call__(self, request):
        response = await self.get_response(request)
        return response

    async def process_request(self, request):
        print(&quot;视图执行之前!!&quot;)

    async def process_response(self, request, response):
        print(&quot;视图执行以后！！&quot;)
        return response
</code></pre>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/note/编程基础/python/进阶使用/django/2025-8-2-11-组件.html">
                            <span class="icon"></span>
                            <span class="label">2025-8-2-11-组件</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                        <a href="/note/编程基础/python/进阶使用/pyQT/2024-5-11-08界面容器.html">
                            <span class="label">2024-5-11-08界面容器</span>
                            <span class="icon"></span>
                        </a>
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a>链接</a><ul><li><a target="_blank" href="https://teedoc.neucrack.com">网站使用 teedoc 生成</a></li>
<li><a target="_blank" href="https://neucrack.com">Copyright © 2021 Neucrack</a></li>
<li><a  href="/note/sitemap.xml">网站地图</a></li>
</ul>
</li>
<li><a>源码</a><ul><li><a target="_blank" href="https://github.com/XuSenfeng/note/">github</a></li>
<li><a target="_blank" href="https://github.com/teedoc/teedoc">本网站源文件</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://beian.miit.gov.cn">渝ICP备19015320号</a></li>
<li><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030602004109">粤公网安备44030602004109号</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/note/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script type="text/javascript">
                var transLoaded = false;
                var loading = false;
                var domain = "translate.google.com";
                var domainDefault = domain;
                var storeDomain = localStorage.getItem("googleTransDomain");
                if(storeDomain){
                    domain = storeDomain;
                    console.log("load google translate domain from local storage:" + domain);
                }
                function getUrl(domain){
                    if(domain == "/")
                        return "/static/js/google_translate/element.js?cb=googleTranslateElementInit";
                    else
                        return "https://" + domain + "/translate_a/element.js?cb=googleTranslateElementInit";
                }
                var url = getUrl(domain);
                console.log("google translate domain:" + domain + ", url: " + url);
                function googleTranslateElementInit() {
                    new google.translate.TranslateElement({pageLanguage: "auto", layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
                }
                function loadJS( url, callback ){
                    var script = document.createElement('script');
                    fn = callback || function(){ };
                    script.type = 'text/javascript';
                    if(script.readyState){
                        script.onreadystatechange = function(){
                            if( script.readyState == 'loaded' || script.readyState == 'complete' ){
                                script.onreadystatechange = null;
                                fn();
                            }
                        };
                    }else{
                        script.onload = function(){
                            fn();
                        };
                    }
                    script.src = url;
                    document.getElementsByTagName('head')[0].appendChild(script);
                }
                function removeHint(){
                    var hint = document.getElementById("loadingTranslate");
                    if(hint){
                        hint.remove();
                    }
                }
                var btn = document.getElementById("google_translate_element");
                btn.onclick = function(){
                    if(transLoaded) return;
                    if(loading){
                        var flag = confirm("loading from " + domain + ", please wait, or change domain?");
                        if(flag){
                            newDomain = prompt("domain, default: " + domainDefault + ", now: " + domain);
                            if(newDomain){
                                domain = newDomain;
                                console.log(domain);
                                url = getUrl(domain);
                                loadJS(url, function(){
                                    localStorage.setItem("googleTransDomain", domain);
                                    removeHint()
                                    transLoaded = true;
                                });
                            }
                        }
                        return;
                    }
                    btn.innerHTML = '<span id="loadingTranslate"><img class="icon" src="/note/static/image/google_translate/translate.svg"/>Loading ...</span>';
                    loading = true;
                    loadJS(url, function(){
                        localStorage.setItem("googleTransDomain", domain);
                        removeHint()
                        transLoaded = true;
                    });
                }
                </script>
            
    
        <script src="/note/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/note/static/js/theme_default/main.js"></script>
    
        <script src="/note/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/note/static/css/theme_default/prism.min.js"></script>
    
        <script src="/note/static/js/search/search_main.js"></script>
    
        <script src="/note/static/js/plugin_blog/main.js"></script>
    
        <link rel="stylesheet" href="/note/static/js/add_hint/style.css" type="text/css"/>
    
        <script src="/note/static/js/add_hint/main.js"></script>
    
        <script src="/note/static/js/gitalk/gitalk.min.js"></script>
    
        <script src="/note/static/js/gitalk/main.js"></script>
    
        <script src="/note/static/js/custom.js"></script>
    
</body>

</html>