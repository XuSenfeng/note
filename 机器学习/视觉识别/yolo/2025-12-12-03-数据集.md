# 数据集

## 常用数据集

常用的数据集有Coco数据集以及VOC数据集, VOC一般使用的是VOC2007和VOC2012

可以在roboflow网页, 里面查找,  有不同模型的对应的标注类型

## 数据准备

获取一系列的图片, 视频需要导成图片的格式, 可以采集摄像头的数据

```python
def capture_frame(camera_index: int = 0, warmup: int = 5):
    """Grab a single frame with a short warmup to avoid black images on repeat runs."""
    video = cv2.VideoCapture(camera_index)
    if not video.isOpened():
        raise RuntimeError("Cannot open camera")

    # Throw away a few frames so the sensor adjusts between runs
    for _ in range(warmup):
        video.read()

    ret, frame = video.read()
    video.release()

    if not ret:
        raise RuntimeError("Failed to read frame")

    frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
    plt.imshow(frame)
    plt.axis("off")
    plt.show()

capture_frame()
```

也可以提取视频里面的

```python
video_path = "calling20221009.mp4"
def capture_video_frame(video_path: str, frame_number: int = 0):
    """Capture a specific frame from a video file."""
    video = cv2.VideoCapture(video_path)
    if not video.isOpened():
        raise RuntimeError("Cannot open video file")

    video.set(cv2.CAP_PROP_POS_FRAMES, frame_number)
    ret, frame = video.read()
    video.release()

    if not ret:
        raise RuntimeError("Failed to read frame")

    frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
    plt.imshow(frame)
    plt.axis("off")
    plt.show()

capture_video_frame(video_path, frame_number=10)
```

记录可以使用

```python
video = cv2.VideoCapture(video_path)
num = 0
save_step = 30  # Save every 30 frames
while True:
    ret, frame = video.read()
    if not ret:
        break
    if num % save_step == 0:
        frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
        plt.imsave(f"frame_{num}.jpg", frame_rgb)
    num += 1
video.release()
```

## 标注

### labelimg

使用labelimg进行标注, 需要使用python3.9的环境

```bash
pip install labelimg
```

直接使用labelimage即可启动

<img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213103655706.png" alt="image-20251213103655706" style="zoom:50%;" />

<img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213103730821.png" alt="image-20251213103730821" style="zoom:50%;" />

使用右键创建一个标注框

快捷键: 

+   d: 下一张
+   w: 选框

<img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213111335448.png" style="zoom:50%;" />

<img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213111347986.png" style="zoom:50%;" />

![image-20251213111435989](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213111435989.png)

### 网页

https://www.makesense.ai/: 可以进行在线的标注以及加载辅助模型进行标注

导出

![image-20251213111929520](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213111929520.png)

![image-20251213111943504](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213111943504.png)

获取的数据的格式是相同的

![image-20251213112019186](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213112019186.png)

![image-20251213112042536](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251213112042536.png)

使用yolo模型进行导出