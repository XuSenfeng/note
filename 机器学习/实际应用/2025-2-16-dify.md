# dify

灵活的生成式AI应用开发框架

## 安装

使用一个有宝塔面板的服务器, 使用`http://49.232.36.90:8888/tencentcloud`打开, 安装一个基础环境以及docker容器, 之后下载dify软件即可

> 可以使用`sudo /etc/init.d/bt default`获取账户, 使用`bt`命令设置账户密码

由于这个网址是在docker里面所以需要开一个方向代理

使用前打开8088的端口, 第一次打开的时候使用`ip:8088/install`设置一下管理员

![image-20250218184210721](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181842807.png)

在宝塔的网站里面打开反向代理

![image-20250218184354985](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181843021.png)

## 基础使用

可以在设置里面添加你的API

![image-20250218184829431](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181848496.png)

之后可以使用模型, 可以添加和openAI的数据格式相同的AI, 比如使用Deepbricks注册以后使用openAI的模型

![image-20250218184857837](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181848911.png)

建立的时候可以使用不同的模板

![image-20250218184945666](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181849741.png)

基础设置以后可以在右上角进行发布, 之后可以在网页或者小程序里面使用这个AI

### 使用知识库

![image-20250218191219815](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181912908.png)

![image-20250218191303021](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181913113.png)

> 数据进入以后进行知识库的检索, 最后进入大模型处理输出

![image-20250218191538120](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181915186.png)

![image-20250218191634909](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181916972.png)

可以在这里加入实际使用的文本文件

![image-20250218192220130](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181922178.png)

这里的分段标识符是在检索到这么多个符号以后分段

> 这里的而Q&A分段功能是指将信息或问题按照问题和回答的形式分开展示，使读者能够更清晰地了解问题和相应的答案。通常在文章、网站、电子书或论坛中使用，可以帮助读者快速找到自己感兴趣的信息，同时提供更好的阅读体验。这种形式的文本布局能够使信息更易于理解和消化，使得读者能够更加高效地获取所需的信息。
>
> ![image-20250218211826531](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502182118609.png)
>
> 记录的消息是这种对话的形式

![image-20250218192254057](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181922104.png)

> 父子分段模式是一种文本排版方式，通过将主要内容和相关内容之间建立父子关系，以便更好地组织和呈现信息。在这种模式下，通常会先列出一个主要段落或主要问题（父段落），然后在其下面列出相关的子段落或子问题，形成一个层次结构。这种排版方式可以让读者更方便地理解信息之间的关联性，更明确地了解主题的各个方面。
>
> 父子分段模式在书籍、论文、网页设计等领域都有广泛的应用。通过构建父子关系，可以帮助读者更快速地获取所需信息，同时也有助于提高信息的组织和呈现效果。这种模式不仅使信息更具有层次性和系统性，还有助于读者更深入地理解和探究相关主题。
>
> 使用总结作为检索, 一般第一种比较好

![image-20250218193136703](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181931749.png)

实际使用的检索模型, 以及提取出来的数量, 向量的结果比较好, 推荐使用混合的模型

> 1. 向量检索：
>     向量检索是一种基于向量空间模型的检索方法，将文档和查询都表示为向量，通过计算它们之间的相似度来进行检索。在向量检索中，每个文档和查询都被表示为一个多维向量，向量中的各个维度对应于特定的特征或词项。通常使用余弦相似度等方法来度量文档和查询之间的相似度，从而确定检索结果的相关性。
> 2. 全文检索：
>     全文检索是指在文档中检索包含查询关键词的文本内容。在全文检索中，会对文档的全文进行索引，检索时会匹配查询关键词与文档的全文内容，而不是将文档和查询表示为向量。全文检索通常使用倒排索引等技术来加速检索过程，通过词项的索引位置快速定位包含查询词的文档。
>
> 区别：
>
> 1. 原理：向量检索基于向量空间模型，计算文档和查询之间的相似度；全文检索则是基于文档的全文内容进行匹配。
> 2. 匹配方式：向量检索通过计算相似度来确定检索结果的相关性；全文检索通过匹配查询词与文档全文内容进行搜索。
> 3. 精度：向量检索在相似度计算过程中考虑了向量的权重和语义信息，可以提供较精确的检索结果；全文检索匹配的是文本片段，可能存在匹配不准确或检索结果不够精确的情况。
> 4. 应用场景：向量检索通常用于需要考虑语义相似度和向量表示的信息检索场景；全文检索适用于需要匹配文本内容的检索场景，例如搜索引擎等。

![image-20250218193607441](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181936496.png)

之后添加知识库以及模型

![image-20250218193846536](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181938588.png)

![image-20250218194342941](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181943989.png)

### 网页知识库

![image-20250218195637780](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502181956837.png)

可以使用两个工具, 前面的是国外的

![image-20250218201055717](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502182010771.png)

## 工作流

### 基础流程

+ 输入

可以设置用户输入的变量

![image-20250218213139640](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502182131694.png)

+ 大模型

使用用户的输入变量构建提示词

![image-20250218213112101](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502182131148.png)

+ 输出

选择一个输出的流程

![image-20250218213557434](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502182135496.png)

### 生成图像

可以在工具里面找到这个

![image-20250218221056685](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202502182210735.png)