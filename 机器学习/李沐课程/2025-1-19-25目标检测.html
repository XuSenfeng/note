<!DOCTYPE html>

<html lang="zh-CN"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <meta name="html-generator" content="teedoc-plugin-jupyter-notebook-parser">
        
        <script src="/note/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/note/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/note/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/note/static/css/search/style.css" type="text/css"/>
        
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?4d52982572d5512e9762879ebf063c86";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
        
        <meta name="blog-generator" content="teedoc-plugin-blog">
        
        <link rel="stylesheet" href="/note/static/css/gitalk/gitalk.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/gitalk/custom_gitalk.css" type="text/css"/>
        
        <link rel="stylesheet" href="/note/static/css/custom.css" type="text/css"/>
        
    
    
    <title>ç›®æ ‡æ£€æµ‹ - XvSenfeng's Note</title>
    
    <script type="text/javascript">js_vars = {"teedoc-plugin-ad-hint": {"type": "hint", "label": "â˜†", "content": "è¿™æ˜¯ä¸€ä¸ªæ”¯æŒå›½é™…åŒ–çš„æ¶ˆæ¯ç¤ºä¾‹</br>å–œæ¬¢é¡¹ç›®è¯·<a target=\"_blank\" href=\"https://github.com/teedoc/teedoc\">ç‚¹ä¸‹ â˜† star </a>å“¦~ğŸ¦€ğŸ¦€", "show_times": 2, "show_after_s": 432000, "date": "2021-11-16 14:40", "color": "#a0421d", "link_color": "#e53935", "link_bg_color": "#e6ae5c", "bg_color": "#ffcf89", "color_hover": "white", "bg_color_hover": "#f57c00", "close_color": "#eab971"}}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": null, "update": [], "ts": 0, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/note/">
                
                    <img class="site_logo" src="/note/static/image/logo.png" alt="XvSenfeng logo">
                
                
                    <h2>XvSenfeng</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class=""><a  href="/note/blog/">åšå®¢</a></li>
<li class=""><a  href="/note/Linux/">Linux</a></li>
<li class=""><a  href="/note/ä»£ç åˆ†æ/">ä»£ç åˆ†æ</a></li>
<li class=""><a  href="/note/ä½¿ç”¨è½¯ä»¶/">ä½¿ç”¨è½¯ä»¶</a></li>
<li class=""><a  href="/note/åµŒå…¥å¼/">åµŒå…¥å¼</a></li>
<li class=""><a  href="/note/æ‰‹æœºå®‰å“/">æ‰‹æœºå®‰å“</a></li>
<li class="active"><a  href="/note/æœºå™¨å­¦ä¹ /">æœºå™¨å­¦ä¹ </a></li>
<li class=""><a  href="/note/ç¼–ç¨‹åŸºç¡€/">ç¼–ç¨‹åŸºç¡€</a></li>
<li class=""><a  href="/note/ç½‘ç»œ/">ç½‘ç»œ</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://github.com/XuSenfeng/note/">github</a></li>
</ul>

                <ul class="nav_plugins"><li><a id="google_translate_element"><img class="icon" src="/note/static/image/google_translate/translate.svg"/>Translate</a></li></ul><ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">æœç´¢</span>
                            <div id="search_hints">
                                <span id="search_input_hint">è¾“å…¥å…³é”®è¯ï¼Œå¤šå…³é”®è¯ç©ºæ ¼éš”å¼€</span>
                                <span id="search_loading_hint">æ­£åœ¨åŠ è½½ï¼Œè¯·ç¨å€™ã€‚ã€‚ã€‚</span>
                                <span id="search_download_err_hint">ä¸‹è½½æ–‡ä»¶å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•æˆ–æ£€æŸ¥ç½‘ç»œ</span>
                                <span id="search_other_docs_result_hint">æ¥è‡ªå…¶å®ƒæ–‡æ¡£çš„ç»“æœ</span>
                                <span id="search_curr_doc_result_hint">å½“å‰æ–‡æ¡£æœç´¢ç»“æœ</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-10-5-Transformers.html"><span class="label">2024-10-5-Transformers</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-10-6-Juoyter.html"><span class="label">2024-10-6-Juoyter</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-10-7-Pandasåº“.html"><span class="label">2024-10-7-Pandasåº“</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-10-9-transformså®æˆ˜.html"><span class="label">2024-10-9-transformså®æˆ˜</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-9-21-LLM.html"><span class="label">2024-9-21-LLM</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-9-22-vLLM.html"><span class="label">2024-9-22-vLLM</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-9-22-æ·±åº¦å­¦ä¹ ç¯å¢ƒ.html"><span class="label">2024-9-22-æ·±åº¦å­¦ä¹ ç¯å¢ƒ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-9-23-01pytorch.html"><span class="label">2024-9-23-01pytorch</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /2024-9-8-æœºå™¨å­¦ä¹ .html"><span class="label">2024-9-8-æœºå™¨å­¦ä¹ </span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /index.html"><span class="label">README</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">rvæ¨¡å‹éƒ¨ç½²</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /rvæ¨¡å‹éƒ¨ç½²/2025-11-28-00-é©±åŠ¨ç§»æ¤.html"><span class="label">2025-11-28-00-é©±åŠ¨ç§»æ¤</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /rvæ¨¡å‹éƒ¨ç½²/2025-11-28-01-ç¯å¢ƒæ­å»º.html"><span class="label">2025-11-28-01-ç¯å¢ƒæ­å»º</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /rvæ¨¡å‹éƒ¨ç½²/2025-12-2-02-åŸºç¡€æ¦‚å¿µ.html"><span class="label">2025-12-2-02-åŸºç¡€æ¦‚å¿µ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /rvæ¨¡å‹éƒ¨ç½²/2025-12-3-03-RKNN_Toolkit2.html"><span class="label">2025-12-3-03-RKNN_Toolkit2</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /rvæ¨¡å‹éƒ¨ç½²/2025-12-3-04-RKLLM.html"><span class="label">2025-12-3-04-RKLLM</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /rvæ¨¡å‹éƒ¨ç½²/2026-2-2-05-RKNNå¼€å‘.html"><span class="label">2026-2-2-05-RKNNå¼€å‘</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">vllmä»£ç åˆ†æ</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /vllmä»£ç åˆ†æ/2024-12-31-00-æ•´ä½“æ¡†æ¶.html"><span class="label">2024-12-31-00-æ•´ä½“æ¡†æ¶</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /vllmä»£ç åˆ†æ/2024-12-31-01-collect_env.html"><span class="label">2024-12-31-01-collect_env</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">å…·èº«æ™ºèƒ½</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å…·èº«æ™ºèƒ½/2026-2-2-åŸºç¡€æ¦‚å¿µ.html"><span class="label">2026-2-2-åŸºç¡€æ¦‚å¿µ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å…·èº«æ™ºèƒ½/2026-2-3-02-ä»¿çœŸ.html"><span class="label">2026-2-3-02-ä»¿çœŸ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å…·èº«æ™ºèƒ½/2026-2-3-03-å§¿æ€è§£ç®—.html"><span class="label">2026-2-3-03-å§¿æ€è§£ç®—</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å…·èº«æ™ºèƒ½/2026-2-4-04-SO-ARM101.html"><span class="label">2026-2-4-04-SO-ARM101</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">å®é™…åº”ç”¨</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-1-30-ollama.html"><span class="label">2025-1-30-ollama</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-12-10-è¯­éŸ³è¯†åˆ«.html"><span class="label">2025-12-10-è¯­éŸ³è¯†åˆ«</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-12-22-QLearning.html"><span class="label">2025-12-22-QLearning</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-2-16-dify.html"><span class="label">2025-2-16-dify</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-2-16-langChain.html"><span class="label">2025-2-16-langChain</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-2-23-langchain2.html"><span class="label">2025-2-23-langchain2</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-2-26-Loraå¾®è°ƒ.html"><span class="label">2025-2-26-Loraå¾®è°ƒ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-3-20-COZE.html"><span class="label">2025-3-20-COZE</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /å®é™…åº”ç”¨/2025-4-2-MCP.html"><span class="label">2025-4-2-MCP</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">åµŒå…¥å¼ç§»æ¤</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /åµŒå…¥å¼ç§»æ¤/00ç»†èŠ.html"><span class="label">00ç»†èŠ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /åµŒå…¥å¼ç§»æ¤/2025-12-18-01-æ¨¡å‹é‡åŒ–.html"><span class="label">2025-12-18-01-æ¨¡å‹é‡åŒ–</span><span class=""></span></a></li>
</ul>
</li>
<li class="active_parent no_link"><a><span class="label">ææ²è¯¾ç¨‹</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/0000-0-0-00åŸºç¡€numpy.html"><span class="label">0000-0-0-00åŸºç¡€numpy</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/0000-0-0-00åŸºç¡€pandas.html"><span class="label">0000-0-0-00åŸºç¡€pandas</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2024-10-31-01.html"><span class="label">2024-10-31-01</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2024-11-03-02æ•°æ®ç±»å‹.html"><span class="label">2024-11-03-02æ•°æ®ç±»å‹</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-08-03åŸºç¡€å‡½æ•°.html"><span class="label">2025-1-08-03åŸºç¡€å‡½æ•°</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-08-04æ•°æ®é›†.html"><span class="label">2025-1-08-04æ•°æ®é›†</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-08-05æ„ŸçŸ¥æœº.html"><span class="label">2025-1-08-05æ„ŸçŸ¥æœº</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-09æ¨¡å‹é€‰æ‹©.html"><span class="label">2025-1-09æ¨¡å‹é€‰æ‹©</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-10-10ä¸¢å¼ƒæ³•.html"><span class="label">2025-1-10-10ä¸¢å¼ƒæ³•</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-11-11æ•°å€¼ç¨³å®šæ€§.html"><span class="label">2025-1-11-11æ•°å€¼ç¨³å®šæ€§</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-12-12å±‚å’Œå—.html"><span class="label">2025-1-12-12å±‚å’Œå—</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-12-GPU.html"><span class="label">2025-1-12-GPU</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-12-å®æˆ˜æ¯”èµ›.html"><span class="label">2025-1-12-å®æˆ˜æ¯”èµ›</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-13-13å·ç§¯.html"><span class="label">2025-1-13-13å·ç§¯</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-13-14æ± åŒ–.html"><span class="label">2025-1-13-14æ± åŒ–</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-14-15LeNet.html"><span class="label">2025-1-14-15LeNet</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-14-16AlexNet.html"><span class="label">2025-1-14-16AlexNet</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-14-17VGG.html"><span class="label">2025-1-14-17VGG</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-14-18NiN.html"><span class="label">2025-1-14-18NiN</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-14-19GoogLeNet.html"><span class="label">2025-1-14-19GoogLeNet</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-15-20æ‰¹é‡å½’ä¸€åŒ–.html"><span class="label">2025-1-15-20æ‰¹é‡å½’ä¸€åŒ–</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-15-21æ®‹å·®ç½‘ç»œResNet.html"><span class="label">2025-1-15-21æ®‹å·®ç½‘ç»œResNet</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-16-èŠ¯ç‰‡.html"><span class="label">2025-1-16-èŠ¯ç‰‡</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-17-22æ•°æ®å¢å¹¿.html"><span class="label">2025-1-17-22æ•°æ®å¢å¹¿</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-17-23å¾®è°ƒ.html"><span class="label">2025-1-17-23å¾®è°ƒ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-18-24CIFARæ•°æ®é›†.html"><span class="label">2025-1-18-24CIFARæ•°æ®é›†</span><span class=""></span></a></li>
<li class="active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-19-25ç›®æ ‡æ£€æµ‹.html"><span class="label">2025-1-19-25ç›®æ ‡æ£€æµ‹</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-23-26åŒºåŸŸå·ç§¯ç¥ç»ç½‘ç»œ.html"><span class="label">2025-1-23-26åŒºåŸŸå·ç§¯ç¥ç»ç½‘ç»œ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-1-27è¯­ä¹‰åˆ†å‰².html"><span class="label">2025-2-1-27è¯­ä¹‰åˆ†å‰²</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-10-33é•¿çŸ­æœŸè®°å¿†LSTM.html"><span class="label">2025-2-10-33é•¿çŸ­æœŸè®°å¿†LSTM</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-10-34æ·±åº¦å¾ªç¯ç½‘ç»œ.html"><span class="label">2025-2-10-34æ·±åº¦å¾ªç¯ç½‘ç»œ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-10-35-BPTT.html"><span class="label">2025-2-10-35-BPTT</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-10-36åŒå‘å¾ªç¯ç¥ç»ç½‘ç»œ.html"><span class="label">2025-2-10-36åŒå‘å¾ªç¯ç¥ç»ç½‘ç»œ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-11-37ç¼–ç å™¨è§£ç å™¨.html"><span class="label">2025-2-11-37ç¼–ç å™¨è§£ç å™¨</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-11-38seq2seq.html"><span class="label">2025-2-11-38seq2seq</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-11-39æŸæœç´¢.html"><span class="label">2025-2-11-39æŸæœç´¢</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-11-40æ³¨æ„åŠ›æœºåˆ¶.html"><span class="label">2025-2-11-40æ³¨æ„åŠ›æœºåˆ¶</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-13-41æ³¨æ„åŠ›seq2seq.html"><span class="label">2025-2-13-41æ³¨æ„åŠ›seq2seq</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-15-42è‡ªæ³¨æ„åŠ›.html"><span class="label">2025-2-15-42è‡ªæ³¨æ„åŠ›</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-15-43Transformer.html"><span class="label">2025-2-15-43Transformer</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-15-44BERT.html"><span class="label">2025-2-15-44BERT</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-5-28æ ·å¼è¿ç§».html"><span class="label">2025-2-5-28æ ·å¼è¿ç§»</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-5-29åºåˆ—æ¨¡å‹.html"><span class="label">2025-2-5-29åºåˆ—æ¨¡å‹</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-6-30æ–‡å­—å¤„ç†.html"><span class="label">2025-2-6-30æ–‡å­—å¤„ç†</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-7-31-å¾ªç¯ç¥ç»ç½‘ç»œRNN.html"><span class="label">2025-2-7-31-å¾ªç¯ç¥ç»ç½‘ç»œRNN</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-2-9-32-é—¨æ§å¾ªç¯å•å…ƒGRU.html"><span class="label">2025-2-9-32-é—¨æ§å¾ªç¯å•å…ƒGRU</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">è§†è§‰è¯†åˆ«</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/2025-12-12-04-ç»å…¸ç®—æ³•.html"><span class="label">2025-12-12-04-ç»å…¸ç®—æ³•</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/2025-12-12-05-YoloV1.html"><span class="label">2025-12-12-05-YoloV1</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">K230</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/K230/2026-1-1-01-SDKç¼–è¯‘.html"><span class="label">2026-1-1-01-SDKç¼–è¯‘</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/K230/2026-1-10-03-Linuxä»£ç å¼€å‘.html"><span class="label">2026-1-10-03-Linuxä»£ç å¼€å‘</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/K230/2026-1-3-02-åŸºç¡€åŸç†.html"><span class="label">2026-1-3-02-åŸºç¡€åŸç†</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">MaixCAM</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-11-02-æ¨¡å‹è®­ç»ƒ.html"><span class="label">2025-12-11-02-æ¨¡å‹è®­ç»ƒ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-11-03-å¸¸ç”¨çš„æ¨¡å‹.html"><span class="label">2025-12-11-03-å¸¸ç”¨çš„æ¨¡å‹</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-14-04-Yoloæ¨¡å‹è½¬æ¢.html"><span class="label">2025-12-14-04-Yoloæ¨¡å‹è½¬æ¢</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-14-05-MaixCDKåŸºç¡€ä½¿ç”¨.html"><span class="label">2025-12-14-05-MaixCDKåŸºç¡€ä½¿ç”¨</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-16-06-maixcdkå·¥å…·.html"><span class="label">2025-12-16-06-maixcdkå·¥å…·</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-17-07-ç»„ä»¶.html"><span class="label">2025-12-17-07-ç»„ä»¶</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-17-08-Cameraç¤ºä¾‹.html"><span class="label">2025-12-17-08-Cameraç¤ºä¾‹</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-17-09-APP.html"><span class="label">2025-12-17-09-APP</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-18-06-æ¨¡å‹ç›¸å…³å‚æ•°.html"><span class="label">2025-12-18-06-æ¨¡å‹ç›¸å…³å‚æ•°</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-19-07-AIç¼–è¯‘å™¨.html"><span class="label">2025-12-19-07-AIç¼–è¯‘å™¨</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-19-08-æ¨¡å‹å®ç°.html"><span class="label">2025-12-19-08-æ¨¡å‹å®ç°</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-20-09-MaixPyç¼–è¯‘.html"><span class="label">2025-12-20-09-MaixPyç¼–è¯‘</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-3-00-èµ„æ–™.html"><span class="label">2025-12-3-00-èµ„æ–™</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/MaixCAM/2025-12-5-01ç¼–è¯‘ä¸‹è½½.html"><span class="label">2025-12-5-01ç¼–è¯‘ä¸‹è½½</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">yolo</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-12-02-åŸºç¡€ä½¿ç”¨.html"><span class="label">2025-12-12-02-åŸºç¡€ä½¿ç”¨</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-12-03-æ•°æ®é›†.html"><span class="label">2025-12-12-03-æ•°æ®é›†</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-12-04-é¢„æµ‹.html"><span class="label">2025-12-12-04-é¢„æµ‹</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-13-05-è®­ç»ƒ.html"><span class="label">2025-12-13-05-è®­ç»ƒ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-13-06-yolov5åŸºç¡€ä½¿ç”¨.html"><span class="label">2025-12-13-06-yolov5åŸºç¡€ä½¿ç”¨</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-13-07-AutoDLæœåŠ¡å™¨è®­ç»ƒ.html"><span class="label">2025-12-13-07-AutoDLæœåŠ¡å™¨è®­ç»ƒ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-13-08-yolov5æ¡†æ¶.html"><span class="label">2025-12-13-08-yolov5æ¡†æ¶</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-13-09-ä¿®æ”¹ç½‘ç»œ.html"><span class="label">2025-12-13-09-ä¿®æ”¹ç½‘ç»œ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-13-10-æ¨¡å‹éƒ¨ç½².html"><span class="label">2025-12-13-10-æ¨¡å‹éƒ¨ç½²</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/note/æœºå™¨å­¦ä¹ /è§†è§‰è¯†åˆ«/yolo/2025-12-4-01-yoloå®‰è£….html"><span class="label">2025-12-4-01-yoloå®‰è£…</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1>ç›®æ ‡æ£€æµ‹</h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="æœ€åä¿®æ”¹æ—¥æœŸï¼š 2025-12-14">
                                    2025-12-14
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                            <div id="source_link">
                                <a href="https://github.com/XuSenfeng/note/tree/master/doc/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-19-25ç›®æ ‡æ£€æµ‹.md" target="_blank">
                                    ç¼–è¾‘æœ¬é¡µ
                                </a>
                            </div>
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <p>æ£€æµ‹ä¸€ä¸ªå›¾åƒé‡Œé¢å‡ºç°çš„å†…å®¹ä»¥åŠä»–çš„ä½ç½®</p>
<p>å®é™…ä½¿ç”¨çš„æœ‰ä¸€ä¸ªè¾¹ç¼˜æ¡†, æŠŠå®é™…çš„ä½ç½®æ¡†èµ·æ¥, ä½¿ç”¨å››ä¸ªæ•°å­—è¿›è¡Œå®šä¹‰, åŸç‚¹çš„åæ ‡æ˜¯åœ¨å·¦ä¸Šè§’, è¿™ç§çš„æ•°æ®é›†ä¸€èˆ¬æ¯”è¾ƒå°</p>
<p>å¯ä»¥ä½¿ç”¨æ•°æ®é›†<a href="cocodataset.org"  >cocoæ•°æ®é›†</a></p>
<h2 id="%E5%A6%82%E4%BD%95%E6%A0%87%E4%B8%80%E4%B8%AA%E6%A1%86">å¦‚ä½•æ ‡ä¸€ä¸ªæ¡†</h2>

<pre class="language-python"><code class="language-python">d2l.set_figsize()
img = d2l.plt.imread('../data/catdog.jpg')
d2l.plt.imshow(img)
</code></pre>
<blockquote>
<p>åŠ è½½ä¸€ä¸ªå›¾ç‰‡å¹¶è¿›è¡Œæ£€æµ‹</p>
</blockquote>
<p>å®é™…çš„è¡¨ç¤ºæœ‰å››ä¸ªè§’è¡¨ç¤ºä»¥åŠä¸­å¿ƒç‚¹è¡¨ç¤º, å†™ä¸€ä¸ªè½¬æ¢å‡½æ•°</p>

<pre class="language-python"><code class="language-python"># ä¸¤ç§è¡¨ç¤ºæ–¹å¼çš„è½¬æ¢
def box_corner_to_center(boxes):
    &quot;&quot;&quot;Convert from (upper-left, lower-right) to (center, width, height)&quot;&quot;&quot;
    x1, y1, x2, y2 = boxes[:, 0], boxes[:, 1], boxes[:, 2], boxes[:, 3]
    cx = (x1 + x2) / 2
    cy = (y1 + y2) / 2
    w = x2 - x1
    h = y2 - y1
    # stackç”¨äºåˆå¹¶å¼ é‡, axis=-1è¡¨ç¤ºæ²¿ç€æœ€åä¸€ä¸ªç»´åº¦åˆå¹¶
    boxes = torch.stack((cx, cy, w, h), axis=-1) 
    return boxes

def box_center_to_corner(boxes):
    &quot;&quot;&quot;Convert from (center, width, height) to (upper-left, lower-right)&quot;&quot;&quot;
    cx, cy, w, h = boxes[:, 0], boxes[:, 1], boxes[:, 2], boxes[:, 3]
    x1 = cx - 0.5 * w
    y1 = cy - 0.5 * h
    x2 = cx + 0.5 * w
    y2 = cy + 0.5 * h
    boxes = torch.stack((x1, y1, x2, y2), axis=-1)
    return boxes
</code></pre>
<blockquote>
<p>æµ‹è¯•ä¸€ä¸‹</p>

<pre class="language-python"><code class="language-python">dog_bbox, cat_bbox = [60.0, 45.0, 378.0, 516.0], [400.0, 112.0, 655.0, 493.0]
boxes = torch.tensor((dog_bbox, cat_bbox))
box_center_to_corner(box_corner_to_center(boxes)) == boxes
</code></pre>
</blockquote>
<p>å®é™…ç»˜åˆ¶ä¸€ä¸‹</p>

<pre class="language-python"><code class="language-python">def bbox_to_rect(bbox, color):
    # Convert the bounding box (top-left x, top-left y, bottom-right x,
    # bottom-right y) format to matplotlib format: ((upper-left x, upper-left y),
    # width, height)
    return d2l.plt.Rectangle(
        xy=(bbox[0], bbox[1]), 
        width=bbox[2] - bbox[0], height=bbox[3] - bbox[1],
        fill=False, edgecolor=color, linewidth=2)

fig = d2l.plt.imshow(img)
fig.axes.add_patch(bbox_to_rect(dog_bbox, 'blue'))
fig.axes.add_patch(bbox_to_rect(cat_bbox, 'red'))
</code></pre>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202501192048311.png" alt="image-20250119204810105" /></p>
<h2 id="%E6%9E%84%E5%BB%BA%E6%95%B0%E6%8D%AE%E9%9B%86">æ„å»ºæ•°æ®é›†</h2>

<pre class="language-python"><code class="language-python">import os
import pandas as pd
import torchvision
</code></pre>
<ul>
<li>è¯»å–ä¸€ä¸‹æ•°æ®é›†</li>
</ul>

<pre class="language-python"><code class="language-python">def read_data_bananas(is_train=True):
    data_dir = &quot;../data/bananas&quot;
    csv_fname = os.path.join(data_dir, 'bananas_train' if is_train else 'bananas_val',\
                            'label.csv')
    csv_data = pd.read_csv(csv_fname)
    csv_data = csv_data.set_index('img_name')
    images, targets = [], []
    # iterrows()è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ¯æ¬¡è¿­ä»£è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œ
    # å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¡Œç´¢å¼•ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯è¯¥è¡Œçš„æ•°æ®
    for img_name, target in csv_data.iterrows():
        # ä½¿ç”¨ç¬¬ä¸€ä¸ªæ•°æ®åŠ è½½å›¾ç‰‡
        images.append(torchvision.io.read_image(
            os.path.join(data_dir, 'bananas_train' if is_train else 'bananas_val', &quot;images&quot;, img_name)))
        targets.append(list(target))
    # unsqueeze(1)è¡¨ç¤ºåœ¨ç¬¬äºŒä¸ªç»´åº¦ä¸Šå¢åŠ ä¸€ä¸ªç»´åº¦, ç”¨äºè®°å½•ä¸åŒçš„æ£€æµ‹ç»“æœ
    # / 256è¡¨ç¤ºå°†åƒç´ å€¼ç¼©æ”¾åˆ°0åˆ°1ä¹‹é—´
    return images, torch.tensor(targets).unsqueeze(1) / 256
</code></pre>
<p>çœ‹ä¸€ä¸‹è¿™ä¸€ä¸ªåˆ°åº•è¯»å–çš„ä»€ä¹ˆæ•°æ®</p>

<pre class="language-python"><code class="language-python">data_dir = &quot;../data/bananas&quot;
csv_fname = os.path.join(data_dir, 'bananas_train',
                        'label.csv')
csv_data = pd.read_csv(csv_fname)
csv_data = csv_data.set_index('img_name')
images, targets = [], []
# iterrows()è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæ¯æ¬¡è¿­ä»£è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œå…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¡Œç´¢å¼•ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯è¯¥è¡Œçš„æ•°æ®
for img_name, target in csv_data.iterrows():
    images.append(torchvision.io.read_image(os.path.join(data_dir, 'bananas_train', &quot;images&quot;, img_name)))
    targets.append(list(target))
print(images[0].shape, targets[1])

&quot;&quot;&quot;
torch.Size([3, 256, 256]) [0, 68, 175, 118, 223]
&quot;&quot;&quot;
</code></pre>
<blockquote>
<p>å‰é¢çš„æ˜¯å›¾ç‰‡ä¿¡æ¯, åé¢çš„æ˜¯å›¾ç‰‡çš„ç±»åˆ«åŠ ä½ç½®, ä½¿ç”¨åˆ—è¡¨è¿›è¡Œå­˜å‚¨</p>
</blockquote>

<pre class="language-python"><code class="language-python">class BananasDataset(torch.utils.data.Dataset):
    def __init__(self, is_train):
        self.features, self.labels = read_data_bananas(is_train)
        print('read ' + str(len(self.features)) + 
              (f' training examples' if is_train else f' validation examples'))

    def __getitem__(self, idx):
        return (self.features[idx].float(), self.labels[idx])

    def __len__(self):
        return len(self.features)
</code></pre>
<blockquote>
<p>ä¸€ä¸ªæ•°æ®é›†ç±»</p>
</blockquote>
<ul>
<li>åŠ è½½è¿­ä»£å™¨</li>
</ul>

<pre class="language-python"><code class="language-python">def  load_data_bananas(batch_size):
    train_iter = torch.utils.data.DataLoader(BananasDataset(is_train=True), batch_size, shuffle=True)
    val_iter = torch.utils.data.DataLoader(BananasDataset(is_train=False), batch_size)
    return train_iter, val_iter
</code></pre>
<p>æµ‹è¯•ä¸€ä¸‹æ•ˆæœ</p>

<pre class="language-python"><code class="language-python">batch_size, edge_size = 32, 256
train_iter, _ = load_data_bananas(batch_size)
batch = next(iter(train_iter))
# æ ‡å·çš„1è¡¨ç¤ºæ¯ä¸ªæœ‰ä¸€ä¸ªæ ·æœ¬, 5è¡¨ç¤ºæ¯ä¸ªæ ·æœ¬æœ‰å››ä¸ªä½ç½®å’Œä¸€ä¸ªç±»åˆ«
batch[0].shape, batch[1].shape 

&quot;&quot;&quot;
read 1000 training examples
read 100 validation examples
(torch.Size([32, 3, 256, 256]), torch.Size([32, 1, 5]))
&quot;&quot;&quot;
</code></pre>
<p>æ˜¾ç¤ºä¸€ä¸‹æ•ˆæœ</p>

<pre class="language-python"><code class="language-python"># permute(0, 2, 3, 1)è¡¨ç¤ºå°†ç¬¬0ç»´å’Œç¬¬3ç»´äº¤æ¢ä½ç½®
imgs = (batch[0][0:10].permute(0, 2, 3, 1)) / 256
axes = d2l.show_images(imgs, 2, 5, scale=2)
for ax, label in zip(axes, batch[1][0:10]):
    d2l.show_bboxes(ax, [label[0][1:5] * edge_size], colors=['w'])
</code></pre>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202501201125770.png" alt="image-20250120112533660" /></p>
<h2 id="%E9%94%9A%E6%A1%86">é”šæ¡†</h2>
<p>é¦–å…ˆæå‡ºå¤šä¸ªé”šæ¡†åŒºåŸŸ, é¦–å…ˆé¢„æµ‹ä¸€ä¸‹æ¯ä¸€ä¸ªé”šæ¡†é‡Œé¢æ˜¯å¦æœ‰å…³æ³¨çš„ç‰©ä½“, å¦‚æœæ˜¯é¢„æµ‹ä»è¿™ä¸€ä¸ªé”šæ¡†å‘ç‰©ä½“è¾¹ç¼˜åç§»</p>
<h3 id="IoU%E4%BA%A4%E5%B9%B6%E6%AF%94">IoUäº¤å¹¶æ¯”</h3>
<p>è®¡ç®—ä¸¤ä¸ªæ¡†ä¹‹é—´çš„é‡åˆä½ç½®çš„å¤§å°</p>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202501201130044.png" alt="image-20250120113042966" /></p>
<p>å®é™…è®­ç»ƒçš„æ—¶å€™æ¯ä¸€ä¸ªé”šæ¡†æ˜¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬, å®é™…æ ‡æ³¨çš„æ˜¯èƒŒæ™¯æˆ–è€…ä¸€ä¸ªçœŸå®çš„è¾¹ç¼˜æ¡†(å’ŒæŸä¸€ä¸ªç‰©ä½“å…³è”)</p>
<blockquote>
<p>å®é™…ä½¿ç”¨çš„æ—¶å€™æ£€æµ‹æ‰€æœ‰å€¼é‡Œé¢IoUæœ€å¤§çš„ä¸€ä¸ªæ•°å€¼, å–å‡ºæ¥, ä¹‹åè¿™ä¸€ä¸ªå€¼å¯¹åº”çš„é”šæ¡†ä»¥åŠå¯¹åº”çš„å±æ€§ä¸å†å‚ä¸æ¯”è¾ƒ, ä¾æ¬¡å–å‡ºæ¦‚ç‡æœ€å¤§çš„ä¸ºé¢„æµ‹å€¼</p>
</blockquote>
<h2 id="%E4%BD%BF%E7%94%A8%E9%9D%9E%E6%9E%81%E5%A4%A7%E5%80%BC%E6%8A%91%E5%88%B6NMS">ä½¿ç”¨éæå¤§å€¼æŠ‘åˆ¶NMS</h2>
<p>æ¯ä¸€ä¸ªé”šæ¡†æ˜¯é¢„æµ‹ä¸€ä¸ªè¾¹ç¼˜æ¡†, NMSå¯ä»¥åˆå¹¶ç›¸ä¼¼çš„é¢„æµ‹</p>
<p>å®é™…é€‰ä¸­çš„æ˜¯éèƒŒæ™¯ç±»é‡Œé¢çš„æœ€å¤§é¢„æµ‹å€¼, å»æ‰æ‰€æœ‰å’Œä»–çš„IoUå€¼å¤§äº$\theta$çš„é¢„æµ‹, é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ç›´åˆ°æ‰€æœ‰çš„é¢„æµ‹è¦ä¸è¢«é€‰æ‹©, è¦ä¸è¢«å»æ‰</p>
<h2 id="%E5%AE%9E%E9%99%85%E4%BD%BF%E7%94%A8">å®é™…ä½¿ç”¨</h2>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202501201705996.png" alt="image-20250120170524887" /></p>
<blockquote>
<p>wæ˜¯å›¾ç‰‡å®½, hæ˜¯å›¾ç‰‡é«˜, sæ˜¯å¤§å°å æ€»å›¾ç‰‡æ¯”é‡, ræ˜¯å®½é«˜æ¯”, åªè€ƒè™‘è¿™ä¸€ä¸ªç»„åˆæ˜¯ä¸ºäº†é¿å…äº§ç”Ÿçš„æ•°é‡è¿‡å¤§, è¿™é‡Œçš„s1å’Œr1æ˜¯å®é™…æœ€é€‚åˆçš„, å®é™…çš„æ¯ä¸€ä¸ªåƒç´ çš„ç”Ÿæˆçš„é”šæ¡†æ•°é‡æ˜¯$nums\_size + nums\_ration - 1$</p>
</blockquote>
<ul>
<li>ä¸ºæ¯ä¸€ä¸ªåƒç´ ç”Ÿæˆè‹¥å¹²ä¸ªé”šç‚¹</li>
</ul>
<p>è¿™ä¸€ä¸ªè¿”å›çš„æ˜¯æ¯”ä¾‹, æ‰€ä»¥å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå°çš„æ•°ç»„, ä¹‹åä¹˜å›¾ç‰‡çš„é•¿å®½, è·å–æŒ‰æ¯”ä¾‹ç”Ÿæˆ</p>

<pre class="language-python"><code class="language-python">def multibox_prior(data, sizes, ratios):
    &quot;&quot;&quot;ç”Ÿæˆä»¥æ¯ä¸ªåƒç´ ä¸ºä¸­å¿ƒå…·æœ‰ä¸åŒå½¢çŠ¶çš„é”šæ¡†ã€‚&quot;&quot;&quot;
    in_height, in_width = data.shape[-2:] # è¾“å…¥æ•°æ®çš„é«˜å’Œå®½
    device, num_sizes, num_ratios = data.device, len(sizes), len(ratios)
    # æ¯ä¸ªåƒç´ ç”Ÿæˆçš„é”šæ¡†æ•°é‡
    boxes_per_pixel = (num_sizes + num_ratios - 1) 
    size_tensor = torch.tensor(sizes, device=device)
    ratio_tensor = torch.tensor(ratios, device=device)

    offset_h, offset_w = 0.5, 0.5 # ä¸­å¿ƒåƒç´ çš„åç§»é‡, ä½œç”¨æ˜¯å°†é”šæ¡†çš„ä¸­å¿ƒç‚¹æ”¾åœ¨åƒç´ çš„ä¸­å¿ƒ
    steps_h = 1.0 / in_height
    steps_w = 1.0 / in_width # é«˜å’Œå®½çš„æ­¥å¹…
    # ç”Ÿæˆé”šæ¡†çš„ä¸­å¿ƒç‚¹
    center_h = (torch.arange(in_height, device=device) + offset_h) * steps_h
    center_w = (torch.arange(in_width, device=device) + offset_w) * steps_w
    # ç”Ÿæˆä»¥æ¯ä¸ªåƒç´ ä¸ºä¸­å¿ƒå…·æœ‰ä¸åŒå½¢çŠ¶çš„é”šæ¡†, meshgridå‡½æ•°ç”Ÿæˆä¸¤ä¸ªçŸ©é˜µ, 
    # ä¸€ä¸ªæ˜¯ä»¥center_hä¸ºè¡Œ, ä¸€ä¸ªæ˜¯ä»¥center_wä¸ºåˆ—
    shift_y, shift_x = torch.meshgrid(center_h, center_w)
    # å°†shift_yå’Œshift_xæ‹‰å¹³, ä½œä¸ºé”šæ¡†çš„ä¸­å¿ƒç‚¹
    shift_y, shift_x = shift_y.reshape(-1), shift_x.reshape(-1)

    w = torch.cat((size_tensor * torch.sqrt(ratio_tensor[0]),
                   sizes[0] * torch.sqrt(ratio_tensor[1:])))\
                   * in_height / in_width
    h = torch.cat((size_tensor / torch.sqrt(ratio_tensor[0]),
                   sizes[0] / torch.sqrt(ratio_tensor[1:])))
    anchor_manipulations = torch.stack(
        (-w, -h, w, h)).T.repeat(in_height * in_width, 1) / 2

    out_grid = torch.stack([shift_x, shift_y, shift_x, shift_y],
                           dim=1).repeat_interleave(boxes_per_pixel, dim=0)
    output = out_grid + anchor_manipulations
    return output.unsqueeze(0)
</code></pre>
<p>å®é™…çš„æ•ˆæœ</p>

<pre class="language-python"><code class="language-python">img = d2l.plt.imread('../data/catdog.jpg')
h, w = img.shape[:2]

print(h, w)
X = torch.rand(size=(1, 3, h, w))
Y = multibox_prior(X, sizes=[0.75, 0.5, 0.25], ratios=[1, 2, 0.5])

Y.shape
&quot;&quot;&quot;
560 728
torch.Size([1, 2038400, 4])
&quot;&quot;&quot;
</code></pre>
<blockquote>
<p>è¾“å‡ºçš„æ˜¯å›¾ç‰‡çš„å¤§å°ä»¥åŠå®é™…çš„ç”Ÿæˆçš„é”šæ¡†çš„æ•°é‡</p>
</blockquote>
<p>åšä¸€ä¸ªæ˜¾ç¤ºé”šæ¡†çš„å‡½æ•°, å¯ä»¥æŒ‡å®šé”šæ¡†æ˜¾ç¤ºçš„å›¾ç‰‡, ä½ç½®, æ ‡ç­¾ä»¥åŠé¢œè‰²</p>

<pre class="language-python"><code class="language-python">def show_bboxes(axes, bboxes, labels=None, colors=None):
    # bboxes: n * 4, næ˜¯é”šæ¡†çš„æ•°é‡

    def _make_list(obj, default_values=None):
        # å¦‚æœobjæ˜¯None, è¿”å›default_values, å¦åˆ™è¿”å›obj
        if obj is None:
            obj = default_values
        elif not isinstance(obj, (list, tuple)):
            # isinstanceå‡½æ•°ç”¨äºåˆ¤æ–­objæ˜¯å¦æ˜¯listæˆ–è€…tupleç±»å‹
            obj = [obj]
        return obj

    labels = _make_list(labels)
    colors = _make_list(colors, ['b', 'g', 'r', 'm', 'c'])
    for i, bbox in enumerate(bboxes):
        color = colors[i % len(colors)]
        rect = d2l.bbox_to_rect(bbox.detach().numpy(), color)
        axes.add_patch(rect)
        if labels and len(labels) &gt; i:
            text_color = 'k' if color == 'w' else 'w'
            # å°†é”šæ¡†è¡¨ç¤ºæˆmatplotlibæ ¼å¼é•¿æ–¹å½¢
            axes.text(rect.xy[0], rect.xy[1], labels[i], va='center',
                      ha='center', fontsize=9, color=text_color,
                      bbox=dict(facecolor=color, lw=0))

d2l.set_figsize()
bbox_scale = torch.tensor((w, h, w, h))
fig = d2l.plt.imshow(img)
show_bboxes(fig.axes, boxes[250, 250, :, :] * bbox_scale, [
    's=0.75, r=1', 's=0.5, r=1', 's=0.25, r=1', 's=0.75, r=2', 's=0.75, r=0.5'
])
</code></pre>
<ul>
<li>è®¡ç®—ä¸¤ä¸ªå›¾ç‰‡çš„ç›¸å…³æ€§</li>
</ul>

<pre class="language-python"><code class="language-python">def box_iou(boxes1, boxes2):
    &quot;&quot;&quot;è®¡ç®—ä¸¤ä¸ªé”šæ¡†æˆ–è¾¹ç•Œæ¡†åˆ—è¡¨ä¸­æˆå¯¹çš„äº¤å¹¶æ¯”ã€‚&quot;&quot;&quot;
    box_area = lambda boxes: ((boxes[:, 2] - boxes[:, 0]) *
                              (boxes[:, 3] - boxes[:, 1]))
    areas1 = box_area(boxes1)
    areas2 = box_area(boxes2)
    inter_upperlefts = torch.max(boxes1[:, None, :2], boxes2[:, :2])
    inter_lowerrights = torch.min(boxes1[:, None, 2:], boxes2[:, 2:])
    # clampå‡½æ•°ç”¨äºå°†å°äº0çš„å€¼è®¾ç½®ä¸º0
    inters = (inter_lowerrights - inter_upperlefts).clamp(min=0) 
    inter_areas = inters[:, :, 0] * inters[:, :, 1]
    union_areas = areas1[:, None] + areas2 - inter_areas
    return inter_areas / union_areas
</code></pre>
<ul>
<li>æ‰¾åˆ°æ¯ä¸ªé”šæ¡†ä¸å…¶äº¤å¹¶æ¯”æœ€å¤§çš„çœŸå®è¾¹ç•Œæ¡†ï¼Œå¹¶å°†è¿™äº›é”šæ¡†çš„ç´¢å¼•å­˜å‚¨åœ¨anchors_bbox_map</li>
</ul>
<p>ground_truth: çœŸå®è¾¹ç•Œæ¡†çš„å¼ é‡ã€‚</p>
<p>anchors: é”šæ¡†çš„å¼ é‡ã€‚</p>
<p>iou_threshold: äº¤å¹¶æ¯”é˜ˆå€¼ï¼Œé»˜è®¤å€¼ä¸º 0.5</p>
<blockquote>
<p>æ²¡æœ‰åŒ¹é…åˆ°çš„é”šæ¡†çš„å¯¹åº”è¿”å›å€¼æ˜¯-1, å¦‚æœæŸä¸ªé”šæ¡†æœ‰å¯¹åº”çš„çœŸå®è¾¹ç•Œæ¡†ï¼Œå…¶å€¼ä¸ºè¯¥çœŸå®è¾¹ç•Œæ¡†åœ¨ ground_truth å¼ é‡ä¸­çš„ç´¢å¼•ã€‚</p>
</blockquote>

<pre class="language-python"><code class="language-python">def assign_anchor_to_bbox(ground_truth, anchors, device, iou_threshold=0.5):
    &quot;&quot;&quot;è·å–æ¯ä¸€ä¸ªåˆ†ç±»é‡Œé¢çš„æœ€æ¥è¿‘çš„é‚£ä¸€é¡¹&quot;&quot;&quot;
    num_anchors, num_gt_boxes = anchors.shape[0], ground_truth.shape[0]
    jaccard = box_iou(anchors, ground_truth) # è®¡ç®—äº¤å¹¶æ¯”
    anchors_bbox_map = torch.full((num_anchors,), -1, dtype=torch.long,
                                  device=device) # å°†è¿”å›é”šæ¡†çš„ç´¢å¼•è®¾ç½®ä¸º-1
    max_ious, indices = torch.max(jaccard, dim=1)
    # torch.nonzeroå‡½æ•°ç”¨äºè¿”å›é0å…ƒç´ çš„ç´¢å¼•
    anc_i = torch.nonzero(max_ious &gt;= 0.5).reshape(-1) 
    box_j = indices[max_ious &gt;= 0.5]
    anchors_bbox_map[anc_i] = box_j
    col_discard = torch.full((num_anchors,), -1) # å°†åˆ—è®¾ç½®ä¸º-1
    row_discard = torch.full((num_gt_boxes,), -1)
    for _ in range(num_gt_boxes):
        max_idx = torch.argmax(jaccard)
        box_idx = (max_idx % num_gt_boxes).long() # è®¡ç®—æœ€å¤§å€¼çš„åˆ—ç´¢å¼•
        anc_idx = (max_idx / num_gt_boxes).long() # è®¡ç®—æœ€å¤§å€¼çš„è¡Œç´¢å¼•
        anchors_bbox_map[anc_idx] = box_idx # å°†é”šæ¡†çš„è¿™ä¸€ä¸ªå¯¹åº”ç´¢å¼•è®¾ç½®ä¸ºçœŸå®è¾¹ç•Œæ¡†çš„ç´¢å¼•
        jaccard[:, box_idx] = col_discard # å°†åˆ—è®¾ç½®ä¸º-1
        jaccard[anc_idx, :] = row_discard # å°†è¡Œè®¾ç½®ä¸º-1
    return anchors_bbox_map
</code></pre>
<ul>
<li>å¯¹è·å–çš„é”šæ¡†è®¡ç®—ä¸€ä¸‹åç§»çš„å¤§å°</li>
</ul>
<p>ç»™å®šæ¡†Aå’ŒBï¼Œä¸­å¿ƒåæ ‡åˆ†åˆ« ä¸º(xa, ya)å’Œ(xb, yb)ï¼Œå®½åº¦åˆ†åˆ«ä¸ºwaå’Œwbï¼Œé«˜åº¦åˆ†åˆ«ä¸ºhaå’Œhbï¼Œå¯ä»¥å°†Açš„åç§»é‡æ ‡è®°ä¸º</p>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202501201823821.png" alt="image-20250120182337742" /></p>
<p>å…¶ä¸­å¸¸é‡çš„é»˜è®¤å€¼ä¸º Âµx = Âµy = Âµw = Âµh = 0, Ïƒx = Ïƒy = 0.1 ï¼ŒÏƒw = Ïƒh = 0.2ã€‚</p>

<pre class="language-python"><code class="language-python">def offset_boxes(anchors, assigned_bb, eps=1e-6):
    &quot;&quot;&quot;å¯¹é”šæ¡†åç§»é‡çš„è½¬æ¢ã€‚&quot;&quot;&quot;
    c_anc = d2l.box_corner_to_center(anchors)
    c_assigned_bb = d2l.box_corner_to_center(assigned_bb)
    offset_xy = 10 * (c_assigned_bb[:, :2] - c_anc[:, :2]) / c_anc[:, 2:]
    offset_wh = 5 * torch.log(eps + c_assigned_bb[:, 2:] / c_anc[:, 2:])
    offset = torch.cat([offset_xy, offset_wh], axis=1)
    return offset
</code></pre>
<ul>
<li>ä½¿ç”¨ä»¥ä¸Šçš„ä¸¤ä¸ªæŠ€æœ¯è·å–åˆ°æ‰€æœ‰é”šæ¡†é‡Œé¢æœ‰æ•ˆçš„æ¡†ä»¥åŠä»–å¯¹åº”çš„ç±»å‹å’Œåç§»</li>
</ul>
<p>ä½¿ç”¨éšæœºçš„è¾¹æ¡†ä»¥åŠç”Ÿæˆçš„è¾¹æ¡†æ¥è¿›è¡Œç”Ÿæˆé¢„æµ‹ç»“æœ, å¯¹éšæœºçš„è¾¹æ¡†è¿›è¡Œè®¡ç®—ç§ç±»ä»¥åŠåç§»å’Œæ©ç </p>

<pre class="language-python"><code class="language-python">def multibox_target(anchors, labels):
    &quot;&quot;&quot;ä½¿ç”¨çœŸå®è¾¹ç•Œæ¡†æ ‡è®°é”šæ¡†ã€‚&quot;&quot;&quot;
    batch_size, anchors = labels.shape[0], anchors.squeeze(0)
    batch_offset, batch_mask, batch_class_labels = [], [], []
    device, num_anchors = anchors.device, anchors.shape[0]
    for i in range(batch_size):
        label = labels[i, :, :]
        anchors_bbox_map = assign_anchor_to_bbox(label[:, 1:], anchors,
                                                 device) # å°†æœ€æ¥è¿‘çš„çœŸå®è¾¹ç•Œæ¡†åˆ†é…ç»™é”šæ¡†
        bbox_mask = ((anchors_bbox_map &gt;= 0).float().unsqueeze(-1)).repeat(
            1, 4)
        class_labels = torch.zeros(num_anchors, dtype=torch.long,
                                   device=device)
        assigned_bb = torch.zeros((num_anchors, 4), dtype=torch.float32,
                                  device=device)
        indices_true = torch.nonzero(anchors_bbox_map &gt;= 0)
        bb_idx = anchors_bbox_map[indices_true]
        class_labels[indices_true] = label[bb_idx, 0].long() + 1
        assigned_bb[indices_true] = label[bb_idx, 1:]
        offset = offset_boxes(anchors, assigned_bb) * bbox_mask
        batch_offset.append(offset.reshape(-1))
        batch_mask.append(bbox_mask.reshape(-1))
        batch_class_labels.append(class_labels)
    bbox_offset = torch.stack(batch_offset)
    bbox_mask = torch.stack(batch_mask)
    class_labels = torch.stack(batch_class_labels)
    # è¿”å›çš„bbox_offset, bbox_mask, class_labelsçš„å½¢çŠ¶æ˜¯(æ‰¹é‡å¤§å°, é”šæ¡†æ•°é‡ * 4), (æ‰¹é‡å¤§å°, é”šæ¡†æ•°é‡ * 1), (æ‰¹é‡å¤§å°, é”šæ¡†æ•°é‡ * 1)
    # bbox_offsetæ˜¯åç§»é‡, bbox_maskæ˜¯é”šæ¡†çš„æ©ç , class_labelsæ˜¯ç±»åˆ«æ ‡ç­¾
    return (bbox_offset, bbox_mask, class_labels)
</code></pre>
<p>ä¸‹é¢ä½¿ç”¨è¿™ä¸€ä¸ªå‡½æ•°åšä¸€æ¬¡å¤„ç†</p>

<pre class="language-python"><code class="language-python">ground_truth = torch.tensor([[0, 0.1, 0.08, 0.52, 0.92],
                             [1, 0.55, 0.2, 0.9, 0.88]]) # ä¸¤ä¸ªçœŸå®è¾¹ç•Œæ¡†
anchors = torch.tensor([[0, 0.1, 0.2, 0.3], [0.15, 0.2, 0.4, 0.4],
                        [0.63, 0.05, 0.88, 0.98], [0.66, 0.45, 0.8, 0.8],
                        [0.57, 0.3, 0.92, 0.9]]) # 5ä¸ªç”Ÿæˆçš„é”šæ¡†
 # æ˜¾ç¤ºä¸€ä¸‹åœ¨å›¾ç‰‡é‡Œé¢çš„ä½ç½®
fig = d2l.plt.imshow(img)
show_bboxes(fig.axes, ground_truth[:, 1:] * bbox_scale, ['dog', 'cat'], 'k')
show_bboxes(fig.axes, anchors * bbox_scale, ['0', '1', '2', '3', '4'])
</code></pre>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202501201937793.png" alt="image-20250120193747663" /></p>

<pre class="language-python"><code class="language-python">labels = multibox_target(anchors.unsqueeze(dim=0),
                         ground_truth.unsqueeze(dim=0))

labels[2] # åˆ†ç±»çš„ç»“æœ, 0è¡¨ç¤ºèƒŒæ™¯, 1è¡¨ç¤ºç‹—, 2è¡¨ç¤ºçŒ«
&quot;&quot;&quot;
tensor([[0, 1, 2, 0, 2]])
&quot;&quot;&quot;
labels[1] # æ©ç , ä¸º1çš„è¡¨ç¤ºé”šæ¡†æœ‰æ•ˆ, ä¸º0çš„è¡¨ç¤ºé”šæ¡†æ— æ•ˆ
&quot;&quot;&quot;
tensor([[0., 0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1.,
         1., 1.]])
&quot;&quot;&quot;
labels[0] # åç§»é‡
&quot;&quot;&quot;
tensor([[-0.00e+00, -0.00e+00, -0.00e+00, -0.00e+00,  1.40e+00,  1.00e+01,
          2.59e+00,  7.18e+00, -1.20e+00,  2.69e-01,  1.68e+00, -1.57e+00,
         -0.00e+00, -0.00e+00, -0.00e+00, -0.00e+00, -5.71e-01, -1.00e+00,
          4.17e-06,  6.26e-01]])
&quot;&quot;&quot;
</code></pre>
<ul>
<li>è¿™ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯æ ¹æ®é¢„æµ‹çš„åç§»é‡æ¥è°ƒæ•´é”šæ¡†ï¼Œä»è€Œå¾—åˆ°é¢„æµ‹çš„è¾¹ç•Œæ¡†ã€‚</li>
</ul>
<p>å‡½æ•°é€šè¿‡å°†é”šæ¡†è½¬æ¢ä¸ºä¸­å¿ƒåæ ‡å’Œå®½é«˜ï¼Œç„¶åæ ¹æ®é¢„æµ‹çš„åç§»é‡è°ƒæ•´è¿™äº›å€¼ï¼Œæœ€åå†è½¬æ¢å›å·¦ä¸Šè§’å’Œå³ä¸‹è§’åæ ‡ï¼Œä»è€Œå¾—åˆ°é¢„æµ‹çš„è¾¹ç•Œæ¡†ã€‚è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°å¤šä¸ªå‡½æ•°çš„è°ƒç”¨ï¼ŒåŒ…æ‹¬åæ ‡è½¬æ¢ã€æŒ‡æ•°è®¡ç®—å’Œå¼ é‡æ‹¼æ¥ã€‚</p>

<pre class="language-python"><code class="language-python">def offset_inverse(anchors, offset_preds):
    &quot;&quot;&quot;æ ¹æ®å¸¦æœ‰é¢„æµ‹åç§»é‡çš„é”šæ¡†æ¥é¢„æµ‹è¾¹ç•Œæ¡†ã€‚&quot;&quot;&quot;
    anc = d2l.box_corner_to_center(anchors)
    pred_bbox_xy = (offset_preds[:, :2] * anc[:, 2:] / 10) + anc[:, :2]
    pred_bbox_wh = torch.exp(offset_preds[:, 2:] / 5) * anc[:, 2:]
    pred_bbox = torch.cat((pred_bbox_xy, pred_bbox_wh), axis=1)
    predicted_bbox = d2l.box_center_to_corner(pred_bbox)
    return predicted_bbox
</code></pre>
<ul>
<li>é€šè¿‡æ’åºå’Œ IoU è®¡ç®—ï¼Œé€æ­¥å»é™¤é‡å è¾ƒå¤§çš„é”šæ¡†ï¼Œåªä¿ç•™ç½®ä¿¡åº¦é«˜ä¸”ç‹¬ç«‹çš„é”šæ¡†ã€‚</li>
</ul>
<ol>
<li>ä»Lä¸­é€‰å–ç½®ä¿¡åº¦æœ€é«˜çš„é¢„æµ‹è¾¹ç•Œæ¡†B1ä½œä¸ºåŸºå‡†ï¼Œç„¶åå°†æ‰€æœ‰ä¸B1çš„IoUè¶…è¿‡é¢„å®šé˜ˆå€¼Ïµçš„éåŸºå‡†é¢„æµ‹ è¾¹ç•Œæ¡†ä»Lä¸­ç§»é™¤ã€‚è¿™æ—¶ï¼ŒLä¿ç•™äº†ç½®ä¿¡åº¦æœ€é«˜çš„é¢„æµ‹è¾¹ç•Œæ¡†ï¼Œå»é™¤äº†ä¸å…¶å¤ªè¿‡ç›¸ä¼¼çš„å…¶ä»–é¢„æµ‹è¾¹ç•Œæ¡†ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œé‚£äº›å…·æœ‰éæå¤§å€¼ç½®ä¿¡åº¦çš„è¾¹ç•Œæ¡†è¢«æŠ‘åˆ¶äº†ã€‚</li>
<li>ä»Lä¸­é€‰å–ç½®ä¿¡åº¦ç¬¬äºŒé«˜çš„é¢„æµ‹è¾¹ç•Œæ¡†B2ä½œä¸ºåˆä¸€ä¸ªåŸºå‡†ï¼Œç„¶åå°†æ‰€æœ‰ä¸B2çš„IoUå¤§äºÏµçš„éåŸºå‡†é¢„æµ‹ è¾¹ç•Œæ¡†ä»Lä¸­ç§»é™¤ã€‚</li>
<li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´åˆ°Lä¸­çš„æ‰€æœ‰é¢„æµ‹è¾¹ç•Œæ¡†éƒ½æ›¾è¢«ç”¨ä½œåŸºå‡†ã€‚æ­¤æ—¶ï¼ŒLä¸­ä»»æ„ä¸€å¯¹é¢„æµ‹è¾¹ç•Œæ¡†çš„IoUéƒ½å° äºé˜ˆå€¼Ïµï¼›å› æ­¤ï¼Œæ²¡æœ‰ä¸€å¯¹è¾¹ç•Œæ¡†è¿‡äºç›¸ä¼¼ã€‚</li>
<li>è¾“å‡ºåˆ—è¡¨Lä¸­çš„æ‰€æœ‰é¢„æµ‹è¾¹ç•Œæ¡†ã€‚</li>
</ol>

<pre class="language-python"><code class="language-python">def nms(boxes, scores, iou_threshold):
    # å»é™¤ç½®æ¯”è¾ƒåƒçš„é”šæ¡†, ä»¥åŠç½®ä¿¡åº¦è¾ƒä½çš„é”šæ¡†
    B = torch.argsort(scores, dim=-1, descending=True) # å¯¹ç½®ä¿¡åº¦è¿›è¡Œæ’åº
    keep = [] # è®°å½•ä¿¡æ¯ä½¿ç”¨
    while B.numel() &gt; 0:
        i = B[0]
        keep.append(i) # å–å‡ºå½“å‰ç½®ä¿¡åº¦æœ€é«˜çš„é”šæ¡†ç´¢å¼•
        if B.numel() == 1: break
        iou = box_iou(boxes[i, :].reshape(-1, 4),
                      boxes[B[1:], :].reshape(-1, 4)).reshape(-1)
        # å°†iouå°äºé˜ˆå€¼çš„é”šæ¡†ç´¢å¼•ä¿ç•™
        inds = torch.nonzero(iou &lt;= iou_threshold).reshape(-1) 
        B = B[inds + 1]
    return torch.tensor(keep, device=boxes.device)
</code></pre>
<ul>
<li>ä»ä¸€ç»„å€™é€‰è¾¹ç•Œæ¡†ä¸­é€‰æ‹©æœ€æœ‰å¯èƒ½åŒ…å«ç›®æ ‡çš„è¾¹ç•Œæ¡†ï¼ŒåŒæ—¶æŠ‘åˆ¶é‚£äº›é‡å è¾ƒå¤šçš„å†—ä½™æ¡†ã€‚</li>
</ul>
<p>å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªåŒ…å«é¢„æµ‹è¾¹ç•Œæ¡†ä¿¡æ¯çš„å¼ é‡ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒè¿”å›ä¸€ä¸ªå½¢çŠ¶ä¸º <code>(batch_size, num_anchors, 6)</code> çš„å¼ é‡ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<p>ä½¿ç”¨çš„æ˜¯è¾¹æ¡†ä»¥åŠæ¯ä¸€ä¸ªè¾¹æ¡†å®é™…å¯¹æ¯ä¸€ä¸ªç±»çš„é¢„æµ‹å‡†ç¡®åº¦, å’Œè¾¹æ¡†çš„åç§»ä»¥åŠé˜ˆå€¼</p>
<ol>
<li>class_idï¼šé¢„æµ‹çš„ç±»åˆ«IDã€‚å¦‚æœè¯¥è¾¹ç•Œæ¡†è¢«æŠ‘åˆ¶æˆ–ç½®ä¿¡åº¦ä½äºé˜ˆå€¼ï¼Œåˆ™ä¸º -1ã€‚</li>
<li><code>confidence</code>ï¼šé¢„æµ‹çš„ç½®ä¿¡åº¦åˆ†æ•°ã€‚</li>
<li>predicted_bbï¼šé¢„æµ‹çš„è¾¹ç•Œæ¡†åæ ‡ï¼Œæ ¼å¼ä¸º <code>[xmin, ymin, xmax, ymax]</code>ã€‚</li>
</ol>

<pre class="language-python"><code class="language-python">def multibox_detection(cls_probs, offset_preds, anchors, nms_threshold=0.5,
                       pos_threshold=0.009999999):
    &quot;&quot;&quot;ä½¿ç”¨éæå¤§å€¼æŠ‘åˆ¶æ¥é¢„æµ‹è¾¹ç•Œæ¡†ã€‚&quot;&quot;&quot;
    # è·å–è®¾å¤‡å’Œæ‰¹é‡å¤§å°
    device, batch_size = cls_probs.device, cls_probs.shape[0]
    # å‹ç¼© anchors çš„ç¬¬ä¸€ä¸ªç»´åº¦
    anchors = anchors.squeeze(0)
    # è·å–ç±»åˆ«æ•°é‡å’Œé”šæ¡†æ•°é‡
    num_classes, num_anchors = cls_probs.shape[1], cls_probs.shape[2]
    out = []
    for i in range(batch_size):
        # è·å–ç¬¬ i ä¸ªæ ·æœ¬çš„ç±»åˆ«æ¦‚ç‡å’Œåç§»é¢„æµ‹
        cls_prob, offset_pred = cls_probs[i], offset_preds[i].reshape(-1, 4)
        # è·å–æœ€å¤§ç±»åˆ«æ¦‚ç‡å’Œå¯¹åº”çš„ç±»åˆ« ID
        conf, class_id = torch.max(cls_prob[1:], 0)
        # é€šè¿‡åç§»é€†å˜æ¢å¾—åˆ°é¢„æµ‹çš„è¾¹ç•Œæ¡†
        predicted_bb = offset_inverse(anchors, offset_pred)
        # ä½¿ç”¨éæå¤§å€¼æŠ‘åˆ¶å¾—åˆ°ä¿ç•™çš„è¾¹ç•Œæ¡†ç´¢å¼•
        keep = nms(predicted_bb, conf, nms_threshold)

        # åˆ›å»ºæ‰€æœ‰é”šæ¡†çš„ç´¢å¼•
        all_idx = torch.arange(num_anchors, dtype=torch.long, device=device)
        # åˆå¹¶ä¿ç•™çš„ç´¢å¼•å’Œæ‰€æœ‰ç´¢å¼•
        combined = torch.cat((keep, all_idx))
        # è·å–å”¯ä¸€ç´¢å¼•åŠå…¶è®¡æ•°
        uniques, counts = combined.unique(return_counts=True)
        # æ‰¾åˆ°æœªä¿ç•™çš„ç´¢å¼•
        non_keep = uniques[counts == 1]
        # åˆå¹¶ä¿ç•™å’Œæœªä¿ç•™çš„ç´¢å¼•
        all_id_sorted = torch.cat((keep, non_keep))
        # å°†æœªä¿ç•™çš„ç±»åˆ« ID è®¾ä¸º -1
        class_id[non_keep] = -1
        # æ ¹æ®æ’åºåçš„ç´¢å¼•é‡æ–°æ’åºç±»åˆ« ID å’Œç½®ä¿¡åº¦
        class_id = class_id[all_id_sorted]
        conf, predicted_bb = conf[all_id_sorted], predicted_bb[all_id_sorted]
        # æ‰¾åˆ°ç½®ä¿¡åº¦ä½äºé˜ˆå€¼çš„ç´¢å¼•
        below_min_idx = (conf &lt; pos_threshold)
        # å°†è¿™äº›ç´¢å¼•çš„ç±»åˆ« ID è®¾ä¸º -1
        class_id[below_min_idx] = -1
        # è°ƒæ•´ç½®ä¿¡åº¦
        conf[below_min_idx] = 1 - conf[below_min_idx]
        # å°†ç±»åˆ« IDã€ç½®ä¿¡åº¦å’Œé¢„æµ‹çš„è¾¹ç•Œæ¡†æ‹¼æ¥åœ¨ä¸€èµ·
        pred_info = torch.cat(
            (class_id.unsqueeze(1), conf.unsqueeze(1), predicted_bb), dim=1)
        # å°†ç»“æœæ·»åŠ åˆ°è¾“å‡ºåˆ—è¡¨ä¸­
        out.append(pred_info)
    # è¿”å›æ‰€æœ‰æ‰¹æ¬¡çš„ç»“æœ
    return torch.stack(out)
</code></pre>
<ul>
<li>ä¸‹é¢å®é™…ä½¿ç”¨ä¸€ä¸‹</li>
</ul>

<pre class="language-python"><code class="language-python">anchors = torch.tensor([[0.1, 0.08, 0.52, 0.92], [0.08, 0.2, 0.56, 0.95],
                        [0.15, 0.3, 0.62, 0.91], [0.55, 0.2, 0.9, 0.88]]) # 4ä¸ªé”šæ¡†
offset_preds = torch.tensor([0] * anchors.numel()) # åç§»é‡
cls_probs = torch.tensor([[0] * 4,
                          [0.9, 0.8, 0.7, 0.1],
                          [0.1, 0.2, 0.3, 0.9]]) # ç±»åˆ«æ¦‚ç‡, ä¸‰ä¸ªç±», å››ä¸ªæ¡†

fig = d2l.plt.imshow(img)
show_bboxes(fig.axes, anchors * bbox_scale,
            ['dog=0.9', 'dog=0.8', 'dog=0.7', 'cat=0.9'])
</code></pre>

<pre class="language-python"><code class="language-python">output = multibox_detection(cls_probs.unsqueeze(dim=0),
                            offset_preds.unsqueeze(dim=0),
                            anchors.unsqueeze(dim=0), nms_threshold=0.5)
output
&quot;&quot;&quot;
tensor([[[ 0.00,  0.90,  0.10,  0.08,  0.52,  0.92],
         [ 1.00,  0.90,  0.55,  0.20,  0.90,  0.88],
         [-1.00,  0.80,  0.08,  0.20,  0.56,  0.95],
         [-1.00,  0.70,  0.15,  0.30,  0.62,  0.91]]])
&quot;&quot;&quot;
</code></pre>
<ul>
<li>ç»˜åˆ¶</li>
</ul>

<pre class="language-python"><code class="language-python">fig = d2l.plt.imshow(img)
for i in output[0].detach().numpy():
    if i[0] == -1:
        continue
    label = ('dog=', 'cat=')[int(i[0])] + str(i[1])
    show_bboxes(fig.axes, [torch.tensor(i[2:]) * bbox_scale], label)
</code></pre>
<p><img src="https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/picture/202501201956401.png" alt="image-20250120195627246" /></p>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-18-24CIFARæ•°æ®é›†.html">
                            <span class="icon"></span>
                            <span class="label">2025-1-18-24CIFARæ•°æ®é›†</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                        <a href="/note/æœºå™¨å­¦ä¹ /ææ²è¯¾ç¨‹/2025-1-23-26åŒºåŸŸå·ç§¯ç¥ç»ç½‘ç»œ.html">
                            <span class="label">2025-1-23-26åŒºåŸŸå·ç§¯ç¥ç»ç½‘ç»œ</span>
                            <span class="icon"></span>
                        </a>
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a>é“¾æ¥</a><ul><li><a target="_blank" href="https://teedoc.neucrack.com">ç½‘ç«™ä½¿ç”¨ teedoc ç”Ÿæˆ</a></li>
<li><a target="_blank" href="https://neucrack.com">Copyright Â© 2021 Neucrack</a></li>
<li><a  href="/note/sitemap.xml">ç½‘ç«™åœ°å›¾</a></li>
</ul>
</li>
<li><a>æºç </a><ul><li><a target="_blank" href="https://github.com/XuSenfeng/note/">github</a></li>
<li><a target="_blank" href="https://github.com/teedoc/teedoc">æœ¬ç½‘ç«™æºæ–‡ä»¶</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://beian.miit.gov.cn">æ¸ICPå¤‡19015320å·</a></li>
<li><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030602004109">ç²¤å…¬ç½‘å®‰å¤‡44030602004109å·</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/note/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script type="text/javascript">
                var transLoaded = false;
                var loading = false;
                var domain = "translate.google.com";
                var domainDefault = domain;
                var storeDomain = localStorage.getItem("googleTransDomain");
                if(storeDomain){
                    domain = storeDomain;
                    console.log("load google translate domain from local storage:" + domain);
                }
                function getUrl(domain){
                    if(domain == "/")
                        return "/static/js/google_translate/element.js?cb=googleTranslateElementInit";
                    else
                        return "https://" + domain + "/translate_a/element.js?cb=googleTranslateElementInit";
                }
                var url = getUrl(domain);
                console.log("google translate domain:" + domain + ", url: " + url);
                function googleTranslateElementInit() {
                    new google.translate.TranslateElement({pageLanguage: "auto", layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
                }
                function loadJS( url, callback ){
                    var script = document.createElement('script');
                    fn = callback || function(){ };
                    script.type = 'text/javascript';
                    if(script.readyState){
                        script.onreadystatechange = function(){
                            if( script.readyState == 'loaded' || script.readyState == 'complete' ){
                                script.onreadystatechange = null;
                                fn();
                            }
                        };
                    }else{
                        script.onload = function(){
                            fn();
                        };
                    }
                    script.src = url;
                    document.getElementsByTagName('head')[0].appendChild(script);
                }
                function removeHint(){
                    var hint = document.getElementById("loadingTranslate");
                    if(hint){
                        hint.remove();
                    }
                }
                var btn = document.getElementById("google_translate_element");
                btn.onclick = function(){
                    if(transLoaded) return;
                    if(loading){
                        var flag = confirm("loading from " + domain + ", please wait, or change domain?");
                        if(flag){
                            newDomain = prompt("domain, default: " + domainDefault + ", now: " + domain);
                            if(newDomain){
                                domain = newDomain;
                                console.log(domain);
                                url = getUrl(domain);
                                loadJS(url, function(){
                                    localStorage.setItem("googleTransDomain", domain);
                                    removeHint()
                                    transLoaded = true;
                                });
                            }
                        }
                        return;
                    }
                    btn.innerHTML = '<span id="loadingTranslate"><img class="icon" src="/note/static/image/google_translate/translate.svg"/>Loading ...</span>';
                    loading = true;
                    loadJS(url, function(){
                        localStorage.setItem("googleTransDomain", domain);
                        removeHint()
                        transLoaded = true;
                    });
                }
                </script>
            
    
        <script src="/note/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/note/static/js/theme_default/main.js"></script>
    
        <script src="/note/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/note/static/css/theme_default/prism.min.js"></script>
    
        <script src="/note/static/js/search/search_main.js"></script>
    
        <script src="/note/static/js/plugin_blog/main.js"></script>
    
        <link rel="stylesheet" href="/note/static/js/add_hint/style.css" type="text/css"/>
    
        <script src="/note/static/js/add_hint/main.js"></script>
    
        <script src="/note/static/js/gitalk/gitalk.min.js"></script>
    
        <script src="/note/static/js/gitalk/main.js"></script>
    
        <script src="/note/static/js/custom.js"></script>
    
</body>

</html>