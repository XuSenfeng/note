# SDK编译

两个仓库

+ [kendryte/k230_linux_sdk: K230 Linux SDK](https://github.com/kendryte/k230_linux_sdk)
+ [kendryte/k230_rtos_sdk](https://github.com/kendryte/k230_rtos_sdk)是基于K230芯片和RT-Smart实时操作系统的软件开发套件，提供完整的开发环境和工具链，帮助开发者快速构建嵌入式应用。CanMV_K230项目是本SDK的典型应用案例，通过MicroPython框架简化了硬件评估和原型开发流程

| 维度           | K230 RTOS SDK                        | K230 Linux SDK                                |
| -------------- | ------------------------------------ | --------------------------------------------- |
| **系统内核**   | 实时操作系统（FreeRTOS/RT-Thread）   | Linux 内核（如基于 OpenWrt、Buildroot 构建）  |
| **资源占用**   | 极低（内存占用通常 < 10MB）          | 较高（内存占用≥64MB）                         |
| **实时性**     | 强（微秒级响应）                     | 弱（毫秒级响应，非硬实时）                    |
| **适用场景**   | 工业控制、实时数据采集、低功耗终端   | 复杂应用（如 Qt 界面、多进程服务、网络应用）  |
| **开发复杂度** | 较低（API 简洁，专注硬件和实时任务） | 较高（需掌握 Linux 系统、驱动开发、进程管理） |

目前官方提供的有三种, Linux, Linux+RTOS, RTOS

## 创建docker

```bash
docker build -f tools/docker/Dockerfile -t k230/linux_sdk tools/docker
docker run -it -h k230 -e uid=$(id -u) -e gid=$(id -g) -e user=${USER} -v ${HOME}/k230:${HOME}/k230 -w $(pwd) --name k230 k230/linux_sdk:latest



docker run -it \
  -h k230 \
  -e uid=$(id -u) \
  -e gid=$(id -g) \
  -e user=${USER} \
  -v ${HOME}/k230:${HOME}/k230 \
  -w $(pwd) \
  --name k230 \
  --privileged \
  --security-opt seccomp=unconfined \
  k230/linux_sdk:latest
```

## linux+RTOS

[kendryte/k230_sdk: Kendryte K230 SDK](https://github.com/kendryte/k230_sdk)

```bash
git clone https://github.com/kendryte/k230_sdk
cd k230_sdk
make prepare_sourcecode
docker run -u root -it -v $(pwd):$(pwd) -v $(pwd)/toolchain:/opt/toolchain -w $(pwd) ghcr.io/kendryte/k230_sdk /bin/bash
make CONF=k230_evb_defconfig
```

输出的文件在k230_evb_defconfig/images位置

```bash

```

## RTOS版本CamMV

```bash
pip3 install pycryptodome gmssl scons==3.1.2

repo init -u git@gitee.com:canmv-k230/manifest.git -b master --repo-url=git@gitee.com:canmv-k230/git-repo.git --repo-branch stable
repo sync
make dl_toolchain
# 列出可用的配置选项
make list_def
# 选择对应的板子配置文件
make xxxx_defconfig
# 开始编译
time make log
```

## Linux版本

[K230 linux SDK镜像编译指南 — K230 Linux SDK](https://www.kendryte.com/k230_linux/zh/dev/userguide/how_to_build.html)

```bash
git clone git@gitee.com:kendryte/k230_linux_sdk.git
# 工具链配置
# https://kendryte-download.canaan-creative.com/k230/downloads/dl/gcc/Xuantie-900-gcc-linux-6.6.0-glibc-x86_64-V3.0.2-20250410.tar.gz
mkdir -p /opt/toolchain
tar -zxvf Xuantie-900-gcc-linux-6.6.0-glibc-x86_64-V3.0.2.tar.gz -C /opt/toolchain
make CONF=k230d_canmv_defconfig 
```

输出的文件为`output/k230d_canmv_defconfig/images/sysimage-sdcard.img.gz`

### 编译的原理

1、从buildroot官网下载buildroot-2025.02.1.gz压缩包，并解压缩为output/buildroot-2025.02.1/

2、用buildroot-overlay目录覆盖output/buildroot-2025.02.1/目录

```
rsync -a  buildroot-overlay/ output/buildroot-2025.02.1/
```

3、进入output/buildroot-2025.02.1/目录，使用k230d_canmv_defconfig配置buildroot，并指定输出目录为output/k230d_canmv_defconfig

```
make -C output/buildroot-2025.02.1 k230d_canmv_defconfig O=/home/wangjianxin/k230_linux_sdk/output/k230d_canmv_defconfig
```

4、 进入output/k230d_canmv_defconfig 目录并进行编译

```
make -C /home/wangjianxin/k230_linux_sdk/output/k230d_canmv_defconfig all
```

## Micropython

[进阶 - 自定义固件 — CanMV K230](https://www.kendryte.com/k230_canmv/zh/main/zh/userguide/how_to_build.html)
