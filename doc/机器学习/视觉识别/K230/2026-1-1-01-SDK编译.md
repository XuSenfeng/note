# SDK编译

两个仓库

+ [kendryte/k230_linux_sdk: K230 Linux SDK](https://github.com/kendryte/k230_linux_sdk)
+ [kendryte/k230_rtos_sdk](https://github.com/kendryte/k230_rtos_sdk)是基于K230芯片和RT-Smart实时操作系统的软件开发套件，提供完整的开发环境和工具链，帮助开发者快速构建嵌入式应用。CanMV_K230项目是本SDK的典型应用案例，通过MicroPython框架简化了硬件评估和原型开发流程

| 维度           | K230 RTOS SDK                        | K230 Linux SDK                                |
| -------------- | ------------------------------------ | --------------------------------------------- |
| **系统内核**   | 实时操作系统（FreeRTOS/RT-Thread）   | Linux 内核（如基于 OpenWrt、Buildroot 构建）  |
| **资源占用**   | 极低（内存占用通常 < 10MB）          | 较高（内存占用≥64MB）                         |
| **实时性**     | 强（微秒级响应）                     | 弱（毫秒级响应，非硬实时）                    |
| **适用场景**   | 工业控制、实时数据采集、低功耗终端   | 复杂应用（如 Qt 界面、多进程服务、网络应用）  |
| **开发复杂度** | 较低（API 简洁，专注硬件和实时任务） | 较高（需掌握 Linux 系统、驱动开发、进程管理） |

# 创建docker

```bash
docker build -f tools/docker/Dockerfile -t wjx/d tools/docker
docker run -it -h k230 -e uid=$(id -u) -e gid=$(id -g) -e user=${USER} -v ${HOME}/k230:${HOME}/k230 -w $(pwd) --name k230 wjx/d:latest
```



## RTOS编译

```bash
# python环境
pip3 config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple

# 安装 Python 依赖库
pip3 install -U pyyaml pycryptodome gmssl jsonschema jinja2

# 安装repo
mkdir -p ~/.bin
curl https://storage.googleapis.com/git-repo-downloads/repo > ~/.bin/repo
chmod a+rx ~/.bin/repo
echo 'export PATH="$HOME/.bin:$PATH"' >> ~/.bashrc
source ~/.bashrc
# 下载代码
repo init -u https://github.com/canmv-k230/manifest -m rtsmart.xml \
   --repo-url=https://github.com/canmv-k230/git-repo.git
   
repo sync -j $(nproc)
make dl_toolchain
make list-def
make k230_canmv_yahboom_defconfig
time make log
```

输出的文件在output/k230_canmv_yahboom_defconfig/位置

```bash
rtos_k230/
├── boards/          # 硬件板级支持文件
├── configs/         # 编译配置文件（如 xxxx_defconfig）
├── output/          # 编译输出目录（镜像、临时文件）
├── src/
│   ├── applications # 用户应用程序
│   ├── opensbi/     # OpenSBI 引导程序
│   ├── rtsmart/     # RT-Smart 实时操作系统
│   └── uboot/       # U-Boot 引导加载程序
└── tools/           # 编译工具链与脚本
```

## Micropython

```bash
bash -c 'dpkg --add-architecture i386 && \
  apt-get clean all && \
  apt-get update && \
  apt-get install -y --fix-broken --fix-missing --no-install-recommends \
    sudo vim wget curl git git-lfs openssh-client net-tools sed tzdata expect mtd-utils inetutils-ping locales \
    sed make cmake binutils build-essential diffutils gcc g++ bash patch gzip bzip2 perl tar cpio unzip rsync \
    file bc findutils dosfstools mtools bison flex autoconf automake python3 python3-pip python3-dev python-is-python3 \
    lib32z1 scons libncurses5-dev kmod fakeroot pigz tree doxygen gawk pkg-config libyaml-dev libconfuse2 libconfuse-dev \
    libssl-dev libc6-dev-i386 libncurses5:i386'

git clone https://gitee.com/ainiyaoyao/genimage.git -b v16 /tmp/genimage
sudo bash -c 'cd /tmp/genimage && \
    ./autogen.sh && \
    ./configure && \
    make -j && \
    make install && \
    cd -'
    
git clone https://github.com/kendryte/k230_canmv
cd k230_canmv
make prepare_sourcecode
sudo bash -c 'ln -s `realpath k230_sdk/toolchain` /opt/toolchain'

```

## CamMV

```bash
pip3 install pycryptodome gmssl scons==3.1.2

repo init -u git@gitee.com:canmv-k230/manifest.git -b master --repo-url=git@gitee.com:canmv-k230/git-repo.git --repo-branch stable
repo sync
make dl_toolchain
# 列出可用的配置选项
make list_def
# 选择对应的板子配置文件
make xxxx_defconfig
# 开始编译
time make log
```

