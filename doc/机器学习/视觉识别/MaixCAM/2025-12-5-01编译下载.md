# 编译下载

## Linux内核

下载代码

```bash
git clone https://github.com/sipeed/LicheeRV-Nano-Build --depth=1
cd LicheeRV-Nano-Build
git clone https://github.com/sophgo/host-tools --depth=1
```

编译的时候需要检查git里面的信息, 所以需要使用git, 下面是实际的导出容器使用的命令

```c
cd host/ubuntu
docker build -t licheervnano-build-ubuntu .
docker run --name licheervnano-build-ubuntu licheervnano-build-ubuntu
docker export licheervnano-build-ubuntu > licheervnano-build-ubuntu.tar
mksquashfs licheervnano-build-ubuntu.tar licheervnano-build-ubuntu.sqfs -tar
mkdir -p tmp_squashfs
# 解压 tar 包到临时目录（-C 指定解压路径）
tar -xf licheervnano-build-ubuntu.tar -C tmp_squashfs
mksquashfs tmp_squashfs licheervnano-build-ubuntu.sqfs -comp gzip
rm -rf tmp_squashfs
```

Ubuntu默认下载的singularity是不对的需要自己编译下载

```bash
# 卸载错误的singularity游戏包
sudo apt remove -y singularity
# 1. 安装依赖
sudo apt update && sudo apt install -y  build-essential libssl-dev uuid-dev libgpgme11-dev squashfs-tools libseccomp-dev wget pkg-config git cryptsetup-bin
wget https://go.dev/dl/go1.21.9.linux-amd64.tar.gz
sudo rm -rf /usr/local/go
sudo tar -C /usr/local -xzf go1.21.9.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc
git clone https://github.com/sylabs/singularity.git
cd singularity && git checkout v3.11.4
./mconfig && cd builddir
git submodule update --init
cd singularity && git checkout v3.11.4
git checkout v3.11.4
./mconfig && cd builddir
make && sudo make install
singularity --version
cd ../../
singularity shell -e licheervnano-build-ubuntu.sqfs
```

现在进入对应的环境里面了

```bash
source build/cvisetup.sh
# C906:
defconfig sg2002_licheervnano_sd
# A53:
# defconfig sg2002_licheea53nano_sd
build_all
```

编译以后得结果

```bash
--------------->8------------------
# please use win32diskimager or dd command write it into sdcard


/home/jiao/MiaxCAM/linuxSDK/LicheeRV-Nano-Build/install/soc_sg2002_licheervnano_sd/images/2025-12-05-16-30-27b96a.img


--------------->8------------------
~/MiaxCAM/linuxSDK/LicheeRV-Nano-Build
```

## 编译MaixPy

```bash
git clone https://github.com/sipeed/MaixPy
git clone https://github.com/sipeed/MaixCDK
sudo apt install git cmake build-essential python3 python3-pip autoconf automake libtool
cmake --version # cmake 版本应该 >= 3.13
cd MaixCDK
pip install -U pip                     # 更新 pip 到最新版本
pip install -U -r requirements.txt     # 安装依赖
export MAIXCDK_PATH=~/maix/MaixCDK
cd ~/maix/MaixPy
python setup.py bdist_wheel maixcam
```

构建成功后, 你会在 `dist` 目录中找到 wheel 文件, 传输到设备（开发板），在设备终端中使用 `pip install -U MaixPy****.whl` 在你的设备上安装或升级

## 安装

- 对于 MaixCAM 还需要放一些额外的文件进去，到[MaixPy release](https://github.com/sipeed/MaixPy/releases) 下载最新的 `builtin_files.tar.xz` 文件。

```bash
tar -xJf builtin_files.tar.xz
sudo apt install -y mtools
sudo apt install -y libfuse2
```

```bash
(base) jiao@jiao-virtual-machine:~/MiaxCAM/maixpy/MaixPy/tools/os/maixcam$ ./gen_os.sh /home/jiao/MiaxCAM/linuxSDK/LicheeRV-Nano-Build/install/soc_sg2002_licheervnano_sd/images/2025-12-05-16-30-27b96a.img ../../../dist/MaixPy-4.12.1-py3-none-any.whl ./maixcam_builtin_files 0 maixcam-pro
```

输出结果是

```bash
~/MaixCam/maixpy/MaixPy/tools/os/maixcam/images/maixcam-pro-2025-12-12-maixpy-v4.12.1.img.xz 
```

