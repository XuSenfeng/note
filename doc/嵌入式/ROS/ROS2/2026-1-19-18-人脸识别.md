# 人脸识别

## 工作空间

### 参数

```bash
ros2 pkg create face_recognize_interface --dependencies sensor_msgs rosidl_default_generators 
```

```xml
<member_of_group>rosidl_interface_packages</member_of_group>
```

![image-20260119172711211](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202601191727314.png)

```cmake
rosidl_generate_interfaces(${PROJECT_NAME}
  "srv/FaceDetector.srv"
  DEPENDENCIES sensor_msgs
)
```

```xml
sensor_msgs/Image image
---
int16 number
float32 use_time
int32[] top
int32[] left
int32[] bottom
int32[] right
```

### server

```bash
ros2 pkg create face_recognize_interface --dependencies senser_msgs rosidl_default_generators 
```

```python
data_files=[
    ('share/ament_index/resource_index/packages',
        ['resource/' + package_name]),
    ('share/' + package_name, ['package.xml']),
    ('share/' + package_name + '/resource', ['resource/default.jpg']),
],
```



## 代码实现

### 创建参数



### 人脸检测

可以使用python里面的库进行人脸的检测

```bash
pip install face_recognition
```

```python
import rclpy
from rclpy.node import Node
import face_recognition
import cv2
from ament_index_python.packages import get_package_share_directory # 用于获取包路径


def main():
    # Get the path to the default image in the package resources
    default_image_path = get_package_share_directory('face_recognize_server') + '/resource/default.jpg'
    print(f"Default image path: {default_image_path}")

    # 加载默认图像并进行人脸编码
    image = cv2.imread(default_image_path)
    face_locations = face_recognition.face_locations(image, number_of_times_to_upsample=1, model="cnn")
    # 绘制人脸位置框
    for (top, right, bottom, left) in face_locations:
        cv2.rectangle(image, (left, top), (right, bottom), (0, 255, 0), 2)
    cv2.imshow("Default Image with Face Locations", image)
    cv2.waitKey(0)
```

