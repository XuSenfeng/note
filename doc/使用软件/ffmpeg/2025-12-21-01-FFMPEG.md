# FFMPEG

是一个MPEG视频编码标准的, 用于记录转换数字音视频, 转化为流的计算机程序, 可以实现不同的音视频的转换

## 基础概念

+   容器: 特定的音视频格式, 比如mp4

+   媒体流: 时间轴上面的一段数据, 比如声音, 字幕, 视频数据等, 可以是压缩的和没有压缩的数据, 压缩数据需要有对应的编解码器

+   数据帧/数据包: 通常一个媒体流是大量的数据帧的集合, 记录最小的数据单元, 不同的媒体流帧交错的存在媒体流里面

    一般使用Frame记录压缩前的数据, packet记录压缩后的数据

+   编解码器: 帧为单位实现压缩数据以及原始数据转换的, 比如图像的YUV和H264之间的转换, 音频的PCM和AAC之间的转换

+   复用mux: 不同的流按照规则放到容器里面

+   解复用: 不同流从容器里面解析出来

+   码率: 比特率, 确定一个视频音频文件的质量的参数, 秒为单位处理的数据bit数量, 使用bps表示, 和视频的质量是正比的
+   帧率: 视频里面的每一秒的帧数

>   视频文件的基本特征

## 安装

```bash
brew install ffmpeg
```

### ffmpeg/ffplay//ffprobe

+   ffmpeg

Hyper fast Audio and Video encoder

音视频编码器

+   ffplay

一个简易的音视频播放器

+   ffprobe

多媒体流分析器

### 相关文档

可以使用命令查看信息

```bash
ffmpeg -h
ffmpeg -h long # 高级信息
ffmpeg -h full # 所有信息
ffplay -h # 只有一个
ffprobe -h
```

可以使用`>`重定向到文件里面进行查看

```bash
usage: ffmpeg [options] [[infile options] -i infile]... {[outfile options] outfile}...
usage: ffplay [option] input_file
usage: ffprobe [OPTIONS] [INPUT_FILE]
```

有部分的基本参数是通用的, 在使用的时候需要注意

## 处理基本流程

```bash
ffmpeg -i test_1920x1080.mp4 -acodec copy -vcodec libx264 -s 1280x720 test_1280x720.flv
```

![image-20251221163114506](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/mac-picture/image-20251221163114506.png)

音频这里使用的是copy, 所以只处理视频, 先对数据进行拆分解压, 之后处理压缩重组

`-acodec` = audio codec（音频编码器），`copy` = 直接拷贝输入的音频流（不重新编码）✅ 优点：速度极快、无音质损失；❌ 前提：输出格式（FLV）需支持输入的音频编码（如 AAC/MP3）

`-vcodec` = video codec（视频编码器），指定视频用 `libx264`（H.264/AVC 编码）💡 最常用的视频编码，兼容性好、压缩率高，是 FLV/MP4 等格式的主流选择

`-s` = size（分辨率），指定输出视频的分辨率为 `1280x720`（720P）