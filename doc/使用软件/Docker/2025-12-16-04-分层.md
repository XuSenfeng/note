# 分层

**Docker 镜像的分层架构本质** —— 镜像是由多个**只读的、不可修改的文件系统层**（Layer）通过「联合文件系统（UnionFS）」叠加而成的，而 `RUN` 是触发 “新增层” 的核心指令之一

Docker 镜像的底层是**联合文件系统（UnionFS）**，它的核心特点是：

-   所有层都是**只读的**（Immutable），一旦创建就无法修改；
-   新层只会记录 “与上一层的差异”（增量存储），而非复制整个文件系统；
-   容器启动时，会在镜像的只读层之上加一层**可写层**（容器层），容器内的所有修改都只发生在这一层，不影响底层镜像。

简单说：`FROM` 会拉取基础镜像的所有层，之后每执行一次 `RUN`（或 COPY/ADD），就会在现有层的基础上新增一层，仅保存本次命令带来的文件系统变更

可以通过以下命令查看镜像的分层信息

```python
# 查看镜像的分层列表（每层的 ID、大小、创建指令）
docker history <镜像名:标签>

# 示例：查看 nginx 镜像的分层
docker history nginx:alpine
```

