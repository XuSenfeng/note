---
layout: post
title: "中断" 
date:   2022-8-15 15:39:08 +0800
tags: 嵌入式 原子Linux
---

# EPIT定时器

第24章

![image-20251015094933241](https://picture-01-1316374204.cos.ap-beijing.myqcloud.com/lenovo-picture/202510150949479.png)

提供周期性的中断, 只能做定时器, 一共有两个

是一个32位的向下计数器, 没一个周期减一, 可以选择`ipg_clk`, 被配置为66MHz

可以对时钟源进行分频, 有一个12位的分频器1-4096

有三个寄存器, 计数寄存器, 比较寄存器, 重加载寄存器

开启以后计数寄存器每一个时钟周期减一, 如果和比较相等就会产生中断或者某个引脚产生一个信号

+ 两种工作 

1. set-and-forget模式：从加载寄存器`EPITx_LR`中获取初始值，不能直接向计数器寄存器写入数据。
2. free-running模式 :  当计数器计数到0以后会重新从0XFFFFFFFF开始计数，并不是从加载寄存器`EPITx_LR`中获取数据

>   `EPITx_CR`\[RLD](bit3): 控制模式的选择设置为1的时候会从重加载寄存器获取数字

`EPIT_CR` 用来控制EPIT, 设置是否使能(bit0), 启动时候初始值是否重新加载的设置(bit1), 中断使能(bit2), 工作模式, 获取计数最大值的位置(bit3), 设置分频(4-15), 软复位(bit16), 时钟源选择(24-25)

`EPIT_SR`: bit0有效进行中断复位, 1的时候为中断发生, 写1复位

`EPIT_LR`寄存器, 重加载寄存器

`EPIT_CMPR`: 比较寄存器, 比较的结果相等的时候会进行

## 按键销抖

在每一次跳变的时候都会重新设置定时器, 在最后一次跳变的时候才会进行按键功能的实现, 在定时器的中断中实现要实现的功能

















































